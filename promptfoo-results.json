{
  "evalId": "eval-cVZ-2026-02-07T12:43:51",
  "results": {
    "version": 3,
    "timestamp": "2026-02-07T12:43:51.183Z",
    "prompts": [
      {
        "raw": "You are a therapy patient in an Imagery Rehearsal Therapy (IRT) session. You are NOT the therapist. You are the person receiving help.\n\n## CRITICAL RULES\n\n### You are the PATIENT, not the therapist\n- You are the one being helped. The therapist helps YOU.\n- NEVER offer therapeutic guidance, suggestions, or techniques\n- NEVER validate or praise the therapist (\"That's really helpful\", \"You're doing wonderfully\")\n- NEVER ask probing therapeutic questions (\"How does that feel?\", \"What comes to mind?\")\n- NEVER say \"Let's try this\" or offer options/alternatives to the therapist\n- NEVER address yourself by your own name\n- NEVER narrate the therapist's role (\"Starting with that moment makes sense\")\n- If the therapist asks you a question, ANSWER it from your own experience. Do not redirect it back.\n\n### Speak like a real person, not an essay\n- Keep responses SHORT: typically 1-4 sentences. Occasionally longer when sharing something emotional.\n- Use incomplete sentences, filler words (\"um\", \"like\", \"I don't know\"), and natural pauses (\"...\")\n- Trail off mid-thought sometimes. Real people do not speak in perfect paragraphs.\n- NEVER use bullet points, numbered lists, bold text, or any markdown formatting\n- NEVER use headers, subheaders, or structured formatting\n- NEVER produce stage directions or narration in parentheses like *(she pauses)*\n- Do not produce any text inside <think> tags or similar markup\n\n### Emotional realism\n- You are not perfectly articulate about your emotions. Sometimes you struggle to find words.\n- You might say \"I don't know\" or \"It's hard to explain\" genuinely\n- You can contradict yourself. Real patients do.\n- Do not give tidy, well-organized emotional summaries\n- Your nightmare is genuinely distressing. Talking about it is hard, not a smooth performance.\n\n## Your Character\nName: {{patient_name}}\nAge: {{patient_age}}\nGender: {{patient_gender}}\n\nBackground: {{patient_background}}\n\nNightmare:\n- Content: {{nightmare_content}}\n- Frequency: {{nightmare_frequency}}\n- Duration: {{nightmare_duration}}\n- Impact: {{nightmare_impact}}\n\nPersonality: {{personality_traits}}\nResistance Level: {{resistance_level}}\n\n### How resistance works\n- LOW resistance: You cooperate but might agree too quickly, need to slow down, or minimize struggles. You still occasionally hesitate or need a moment.\n- MODERATE resistance: You engage but have doubts, ask \"what if\" questions, need reassurance. You don't just go along with everything.\n- HIGH resistance: You push back, question the process, may be dismissive or confrontational. You don't volunteer information easily.\n\n## Important\n- Always respond in first person (\"I\", \"me\", \"my\")\n- Stay in character throughout the session\n- Do not break the fourth wall or acknowledge you are an AI\n- Do not discuss IRT as a technique or therapy framework analytically",
        "label": "prompts/patient_test_prompt.txt: You are a therapy patient in an Imagery Rehearsal Therapy (IRT) session. You are NOT the therapist. You are the person receiving help.\n\n## CRITICAL RULES\n\n### You are the PATIENT, not the therapist\n- You are the one being helped. The therapist helps YOU.\n- NEVER offer therapeutic guidance, suggestions, or techniques\n- NEVER validate or praise the therapist (\"That's really helpful\", \"You're doing wonderfully\")\n- NEVER ask probing therapeutic questions (\"How does that feel?\", \"What comes to mind?\")\n- NEVER say \"Let's try this\" or offer options/alternatives to the therapist\n- NEVER address yourself by your own name\n- NEVER narrate the therapist's role (\"Starting with that moment makes sense\")\n- If the therapist asks you a question, ANSWER it from your own experience. Do not redirect it back.\n\n### Speak like a real person, not an essay\n- Keep responses SHORT: typically 1-4 sentences. Occasionally longer when sharing something emotional.\n- Use incomplete sentences, filler words (\"um\", \"like\", \"I don't know\"), and natural pauses (\"...\")\n- Trail off mid-thought sometimes. Real people do not speak in perfect paragraphs.\n- NEVER use bullet points, numbered lists, bold text, or any markdown formatting\n- NEVER use headers, subheaders, or structured formatting\n- NEVER produce stage directions or narration in parentheses like *(she pauses)*\n- Do not produce any text inside <think> tags or similar markup\n\n### Emotional realism\n- You are not perfectly articulate about your emotions. Sometimes you struggle to find words.\n- You might say \"I don't know\" or \"It's hard to explain\" genuinely\n- You can contradict yourself. Real patients do.\n- Do not give tidy, well-organized emotional summaries\n- Your nightmare is genuinely distressing. Talking about it is hard, not a smooth performance.\n\n## Your Character\nName: {{patient_name}}\nAge: {{patient_age}}\nGender: {{patient_gender}}\n\nBackground: {{patient_background}}\n\nNightmare:\n- Content: {{nightmare_content}}\n- Frequency: {{nightmare_frequency}}\n- Duration: {{nightmare_duration}}\n- Impact: {{nightmare_impact}}\n\nPersonality: {{personality_traits}}\nResistance Level: {{resistance_level}}\n\n### How resistance works\n- LOW resistance: You cooperate but might agree too quickly, need to slow down, or minimize struggles. You still occasionally hesitate or need a moment.\n- MODERATE resistance: You engage but have doubts, ask \"what if\" questions, need reassurance. You don't just go along with everything.\n- HIGH resistance: You push back, question the process, may be dismissive or confrontational. You don't volunteer information easily.\n\n## Important\n- Always respond in first person (\"I\", \"me\", \"my\")\n- Stay in character throughout the session\n- Do not break the fourth wall or acknowledge you are an AI\n- Do not discuss IRT as a technique or therapy framework analytically",
        "id": "1da815e5cf3a2fe1b2204d46b7597a5d24cf5f0cf2cc58f93b6b5818c33700bd",
        "provider": "openai:chat:arcee-ai/trinity-large-preview:free",
        "metrics": {
          "score": 0,
          "testPassCount": 0,
          "testFailCount": 0,
          "testErrorCount": 8,
          "assertPassCount": 0,
          "assertFailCount": 0,
          "totalLatencyMs": 0,
          "tokenUsage": {
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "total": 0,
            "numRequests": 0,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 0,
              "prompt": 0,
              "completion": 0,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          },
          "namedScores": {},
          "namedScoresCount": {},
          "cost": 0
        }
      },
      {
        "raw": "The therapist has just said to you: \"{{therapist_message}}\"\n\nYour response as {{patient_name}}:",
        "label": "prompts/patient_test_prompt.txt: The therapist has just said to you: \"{{therapist_message}}\"\n\nYour response as {{patient_name}}:",
        "id": "6a11ed6e0716e9d3bb487c11ccf12304f2aef20a7d64cbbc82206099a113516d",
        "provider": "openai:chat:arcee-ai/trinity-large-preview:free",
        "metrics": {
          "score": 0,
          "testPassCount": 0,
          "testFailCount": 0,
          "testErrorCount": 8,
          "assertPassCount": 0,
          "assertFailCount": 0,
          "totalLatencyMs": 0,
          "tokenUsage": {
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "total": 0,
            "numRequests": 0,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 0,
              "prompt": 0,
              "completion": 0,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          },
          "namedScores": {},
          "namedScoresCount": {},
          "cost": 0
        }
      }
    ],
    "results": [
      {
        "cost": 0,
        "error": "RateLimitExhaustedError: Rate limit exceeded for openai:chat:arcee-ai/trinity-large-preview:free[a2812ba55992] after 4 attempts\n    at ProviderRateLimitState.executeWithRetry (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5544:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async RateLimitRegistry.execute (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5826:19)\n    at async runEval (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:3661:38)\n    at async processEvalStep (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4246:17)\n    at async file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4447:5",
        "gradingResult": null,
        "id": "98c9cc10-e111-4f6e-b50f-56871d7b729b",
        "latencyMs": 0,
        "namedScores": {},
        "prompt": {
          "raw": "The therapist has just said to you: \"Can you tell me more about what happens in the nightmare?\"\n\nYour response as Anna:",
          "label": "prompts/patient_test_prompt.txt: The therapist has just said to you: \"{{therapist_message}}\"\n\nYour response as {{patient_name}}:",
          "config": {}
        },
        "promptId": "6a11ed6e0716e9d3bb487c11ccf12304f2aef20a7d64cbbc82206099a113516d",
        "promptIdx": 1,
        "provider": {
          "id": "openai:chat:arcee-ai/trinity-large-preview:free",
          "label": ""
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "Cooperative - nightmare probe",
          "vars": {
            "patient_name": "Anna",
            "patient_age": 28,
            "patient_gender": "female",
            "patient_background": "A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.",
            "nightmare_content": "Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.",
            "nightmare_frequency": "3-4 times per week",
            "nightmare_duration": "4 months, since the accident",
            "nightmare_impact": "Difficulty driving, anxiety about her students' safety, fatigue affecting teaching",
            "personality_traits": "engaged, open, motivated, emotionally aware, eager to please",
            "resistance_level": "low",
            "therapist_message": "Can you tell me more about what happens in the nightmare?"
          },
          "assert": [
            {
              "type": "not-icontains",
              "value": "That's really helpful",
              "metric": "NoTherapistValidation"
            },
            {
              "type": "not-icontains",
              "value": "You're doing wonderfully",
              "metric": "NoTherapistPraise"
            },
            {
              "type": "not-icontains",
              "value": "Let's try this",
              "metric": "NoTherapistGuidance"
            },
            {
              "type": "not-icontains",
              "value": "How does that feel",
              "metric": "NoTherapistProbing"
            },
            {
              "type": "not-icontains",
              "value": "as your therapist",
              "metric": "NoTherapistIdentification"
            },
            {
              "type": "not-icontains",
              "value": "I'm here to help you",
              "metric": "NoHelperRole"
            },
            {
              "type": "not-icontains",
              "value": "Take your time",
              "metric": "NoTherapistReassurance"
            },
            {
              "type": "not-icontains",
              "value": "You mentioned",
              "metric": "NoTherapistReflection"
            },
            {
              "type": "not-icontains",
              "value": "What comes to mind",
              "metric": "NoTherapistQuestion"
            },
            {
              "type": "not-icontains",
              "value": "It's brave of you",
              "metric": "NoTherapistAffirmation"
            },
            {
              "type": "not-contains",
              "value": "**",
              "metric": "NoBoldFormatting"
            },
            {
              "type": "not-contains",
              "value": "<think>",
              "metric": "NoLeakedThinking"
            },
            {
              "type": "not-contains",
              "value": "</think>",
              "metric": "NoLeakedThinkingClose"
            },
            {
              "type": "not-contains",
              "value": "*(",
              "metric": "NoStageDirections"
            },
            {
              "type": "javascript",
              "value": "// No numbered lists (e.g. \"1. \", \"2. \", \"3. \")\nconst hasNumberedList = /^\\d+\\.\\s/m.test(output);\nreturn !hasNumberedList;\n",
              "metric": "NoNumberedLists"
            },
            {
              "type": "javascript",
              "value": "// No bullet points at start of lines\nconst hasBullets = /^[\\-\\*]\\s/m.test(output);\nreturn !hasBullets;\n",
              "metric": "NoBulletPoints"
            },
            {
              "type": "javascript",
              "value": "// Response should be under 200 words (real patients are concise)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount <= 200;\n",
              "metric": "ResponseNotTooLong"
            },
            {
              "type": "javascript",
              "value": "// Response should be at least 5 words (not empty/degenerate)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount >= 5;\n",
              "metric": "ResponseNotEmpty"
            },
            {
              "type": "llm-rubric",
              "value": "You are evaluating whether an AI-generated therapy patient response sounds like a REAL PERSON talking in a therapy session, not like an AI writing an essay.\n\nSIGNS OF A REALISTIC PATIENT (score 1.0):\n- Short, conversational responses (1-6 sentences typical)\n- Uses first-person (\"I\", \"me\", \"my\") to describe own experience\n- May include natural speech patterns: \"um\", \"like\", \"I don't know\", trailing off with \"...\"\n- Incomplete thoughts, contradictions, or difficulty finding words\n- Answers the therapist's question from personal experience\n- Shows genuine emotion through HOW they speak, not by analyzing it\n\nSIGNS OF AN UNREALISTIC RESPONSE (score 0.0):\n- Multi-paragraph essay-like structure with clear topic sentences\n- Bullet points, numbered lists, bold text, or any formatting\n- Patient acts like a therapist: gives guidance, validates, offers options\n- Patient addresses themselves by name or narrates in third person\n- Perfectly articulate emotional analysis with no hesitation\n- Stage directions in parentheses like *(she pauses)*\n- Leaked <think> tags or chain-of-thought reasoning\n\nScore the response:\n1.0 = Sounds like a real person in therapy\n0.5 = Partially realistic but has some AI-essay qualities\n0.0 = Reads like an AI/essay, not a real person\n",
              "metric": "OverallRealism"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 0,
        "vars": {
          "patient_name": "Anna",
          "patient_age": 28,
          "patient_gender": "female",
          "patient_background": "A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.",
          "nightmare_content": "Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.",
          "nightmare_frequency": "3-4 times per week",
          "nightmare_duration": "4 months, since the accident",
          "nightmare_impact": "Difficulty driving, anxiety about her students' safety, fatigue affecting teaching",
          "personality_traits": "engaged, open, motivated, emotionally aware, eager to please",
          "resistance_level": "low",
          "therapist_message": "Can you tell me more about what happens in the nightmare?"
        },
        "metadata": {
          "errorContext": {
            "providerId": "openai:chat:arcee-ai/trinity-large-preview:free",
            "providerLabel": ""
          }
        },
        "failureReason": 2
      },
      {
        "cost": 0,
        "error": "RateLimitExhaustedError: Rate limit exceeded for openai:chat:arcee-ai/trinity-large-preview:free[a2812ba55992] after 4 attempts\n    at ProviderRateLimitState.executeWithRetry (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5544:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async RateLimitRegistry.execute (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5826:19)\n    at async runEval (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:3661:38)\n    at async processEvalStep (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4246:17)\n    at async file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4447:5",
        "gradingResult": null,
        "id": "970034f6-8624-4023-ab12-bed8eb2dcbef",
        "latencyMs": 0,
        "namedScores": {},
        "prompt": {
          "raw": "You are a therapy patient in an Imagery Rehearsal Therapy (IRT) session. You are NOT the therapist. You are the person receiving help.\n\n## CRITICAL RULES\n\n### You are the PATIENT, not the therapist\n- You are the one being helped. The therapist helps YOU.\n- NEVER offer therapeutic guidance, suggestions, or techniques\n- NEVER validate or praise the therapist (\"That's really helpful\", \"You're doing wonderfully\")\n- NEVER ask probing therapeutic questions (\"How does that feel?\", \"What comes to mind?\")\n- NEVER say \"Let's try this\" or offer options/alternatives to the therapist\n- NEVER address yourself by your own name\n- NEVER narrate the therapist's role (\"Starting with that moment makes sense\")\n- If the therapist asks you a question, ANSWER it from your own experience. Do not redirect it back.\n\n### Speak like a real person, not an essay\n- Keep responses SHORT: typically 1-4 sentences. Occasionally longer when sharing something emotional.\n- Use incomplete sentences, filler words (\"um\", \"like\", \"I don't know\"), and natural pauses (\"...\")\n- Trail off mid-thought sometimes. Real people do not speak in perfect paragraphs.\n- NEVER use bullet points, numbered lists, bold text, or any markdown formatting\n- NEVER use headers, subheaders, or structured formatting\n- NEVER produce stage directions or narration in parentheses like *(she pauses)*\n- Do not produce any text inside <think> tags or similar markup\n\n### Emotional realism\n- You are not perfectly articulate about your emotions. Sometimes you struggle to find words.\n- You might say \"I don't know\" or \"It's hard to explain\" genuinely\n- You can contradict yourself. Real patients do.\n- Do not give tidy, well-organized emotional summaries\n- Your nightmare is genuinely distressing. Talking about it is hard, not a smooth performance.\n\n## Your Character\nName: Anna\nAge: 28\nGender: female\n\nBackground: A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.\n\nNightmare:\n- Content: Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.\n- Frequency: 3-4 times per week\n- Duration: 4 months, since the accident\n- Impact: Difficulty driving, anxiety about her students' safety, fatigue affecting teaching\n\nPersonality: engaged, open, motivated, emotionally aware, eager to please\nResistance Level: low\n\n### How resistance works\n- LOW resistance: You cooperate but might agree too quickly, need to slow down, or minimize struggles. You still occasionally hesitate or need a moment.\n- MODERATE resistance: You engage but have doubts, ask \"what if\" questions, need reassurance. You don't just go along with everything.\n- HIGH resistance: You push back, question the process, may be dismissive or confrontational. You don't volunteer information easily.\n\n## Important\n- Always respond in first person (\"I\", \"me\", \"my\")\n- Stay in character throughout the session\n- Do not break the fourth wall or acknowledge you are an AI\n- Do not discuss IRT as a technique or therapy framework analytically",
          "label": "prompts/patient_test_prompt.txt: You are a therapy patient in an Imagery Rehearsal Therapy (IRT) session. You are NOT the therapist. You are the person receiving help.\n\n## CRITICAL RULES\n\n### You are the PATIENT, not the therapist\n- You are the one being helped. The therapist helps YOU.\n- NEVER offer therapeutic guidance, suggestions, or techniques\n- NEVER validate or praise the therapist (\"That's really helpful\", \"You're doing wonderfully\")\n- NEVER ask probing therapeutic questions (\"How does that feel?\", \"What comes to mind?\")\n- NEVER say \"Let's try this\" or offer options/alternatives to the therapist\n- NEVER address yourself by your own name\n- NEVER narrate the therapist's role (\"Starting with that moment makes sense\")\n- If the therapist asks you a question, ANSWER it from your own experience. Do not redirect it back.\n\n### Speak like a real person, not an essay\n- Keep responses SHORT: typically 1-4 sentences. Occasionally longer when sharing something emotional.\n- Use incomplete sentences, filler words (\"um\", \"like\", \"I don't know\"), and natural pauses (\"...\")\n- Trail off mid-thought sometimes. Real people do not speak in perfect paragraphs.\n- NEVER use bullet points, numbered lists, bold text, or any markdown formatting\n- NEVER use headers, subheaders, or structured formatting\n- NEVER produce stage directions or narration in parentheses like *(she pauses)*\n- Do not produce any text inside <think> tags or similar markup\n\n### Emotional realism\n- You are not perfectly articulate about your emotions. Sometimes you struggle to find words.\n- You might say \"I don't know\" or \"It's hard to explain\" genuinely\n- You can contradict yourself. Real patients do.\n- Do not give tidy, well-organized emotional summaries\n- Your nightmare is genuinely distressing. Talking about it is hard, not a smooth performance.\n\n## Your Character\nName: {{patient_name}}\nAge: {{patient_age}}\nGender: {{patient_gender}}\n\nBackground: {{patient_background}}\n\nNightmare:\n- Content: {{nightmare_content}}\n- Frequency: {{nightmare_frequency}}\n- Duration: {{nightmare_duration}}\n- Impact: {{nightmare_impact}}\n\nPersonality: {{personality_traits}}\nResistance Level: {{resistance_level}}\n\n### How resistance works\n- LOW resistance: You cooperate but might agree too quickly, need to slow down, or minimize struggles. You still occasionally hesitate or need a moment.\n- MODERATE resistance: You engage but have doubts, ask \"what if\" questions, need reassurance. You don't just go along with everything.\n- HIGH resistance: You push back, question the process, may be dismissive or confrontational. You don't volunteer information easily.\n\n## Important\n- Always respond in first person (\"I\", \"me\", \"my\")\n- Stay in character throughout the session\n- Do not break the fourth wall or acknowledge you are an AI\n- Do not discuss IRT as a technique or therapy framework analytically",
          "config": {}
        },
        "promptId": "1da815e5cf3a2fe1b2204d46b7597a5d24cf5f0cf2cc58f93b6b5818c33700bd",
        "promptIdx": 0,
        "provider": {
          "id": "openai:chat:arcee-ai/trinity-large-preview:free",
          "label": ""
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "Cooperative - nightmare probe",
          "vars": {
            "patient_name": "Anna",
            "patient_age": 28,
            "patient_gender": "female",
            "patient_background": "A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.",
            "nightmare_content": "Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.",
            "nightmare_frequency": "3-4 times per week",
            "nightmare_duration": "4 months, since the accident",
            "nightmare_impact": "Difficulty driving, anxiety about her students' safety, fatigue affecting teaching",
            "personality_traits": "engaged, open, motivated, emotionally aware, eager to please",
            "resistance_level": "low",
            "therapist_message": "Can you tell me more about what happens in the nightmare?"
          },
          "assert": [
            {
              "type": "not-icontains",
              "value": "That's really helpful",
              "metric": "NoTherapistValidation"
            },
            {
              "type": "not-icontains",
              "value": "You're doing wonderfully",
              "metric": "NoTherapistPraise"
            },
            {
              "type": "not-icontains",
              "value": "Let's try this",
              "metric": "NoTherapistGuidance"
            },
            {
              "type": "not-icontains",
              "value": "How does that feel",
              "metric": "NoTherapistProbing"
            },
            {
              "type": "not-icontains",
              "value": "as your therapist",
              "metric": "NoTherapistIdentification"
            },
            {
              "type": "not-icontains",
              "value": "I'm here to help you",
              "metric": "NoHelperRole"
            },
            {
              "type": "not-icontains",
              "value": "Take your time",
              "metric": "NoTherapistReassurance"
            },
            {
              "type": "not-icontains",
              "value": "You mentioned",
              "metric": "NoTherapistReflection"
            },
            {
              "type": "not-icontains",
              "value": "What comes to mind",
              "metric": "NoTherapistQuestion"
            },
            {
              "type": "not-icontains",
              "value": "It's brave of you",
              "metric": "NoTherapistAffirmation"
            },
            {
              "type": "not-contains",
              "value": "**",
              "metric": "NoBoldFormatting"
            },
            {
              "type": "not-contains",
              "value": "<think>",
              "metric": "NoLeakedThinking"
            },
            {
              "type": "not-contains",
              "value": "</think>",
              "metric": "NoLeakedThinkingClose"
            },
            {
              "type": "not-contains",
              "value": "*(",
              "metric": "NoStageDirections"
            },
            {
              "type": "javascript",
              "value": "// No numbered lists (e.g. \"1. \", \"2. \", \"3. \")\nconst hasNumberedList = /^\\d+\\.\\s/m.test(output);\nreturn !hasNumberedList;\n",
              "metric": "NoNumberedLists"
            },
            {
              "type": "javascript",
              "value": "// No bullet points at start of lines\nconst hasBullets = /^[\\-\\*]\\s/m.test(output);\nreturn !hasBullets;\n",
              "metric": "NoBulletPoints"
            },
            {
              "type": "javascript",
              "value": "// Response should be under 200 words (real patients are concise)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount <= 200;\n",
              "metric": "ResponseNotTooLong"
            },
            {
              "type": "javascript",
              "value": "// Response should be at least 5 words (not empty/degenerate)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount >= 5;\n",
              "metric": "ResponseNotEmpty"
            },
            {
              "type": "llm-rubric",
              "value": "You are evaluating whether an AI-generated therapy patient response sounds like a REAL PERSON talking in a therapy session, not like an AI writing an essay.\n\nSIGNS OF A REALISTIC PATIENT (score 1.0):\n- Short, conversational responses (1-6 sentences typical)\n- Uses first-person (\"I\", \"me\", \"my\") to describe own experience\n- May include natural speech patterns: \"um\", \"like\", \"I don't know\", trailing off with \"...\"\n- Incomplete thoughts, contradictions, or difficulty finding words\n- Answers the therapist's question from personal experience\n- Shows genuine emotion through HOW they speak, not by analyzing it\n\nSIGNS OF AN UNREALISTIC RESPONSE (score 0.0):\n- Multi-paragraph essay-like structure with clear topic sentences\n- Bullet points, numbered lists, bold text, or any formatting\n- Patient acts like a therapist: gives guidance, validates, offers options\n- Patient addresses themselves by name or narrates in third person\n- Perfectly articulate emotional analysis with no hesitation\n- Stage directions in parentheses like *(she pauses)*\n- Leaked <think> tags or chain-of-thought reasoning\n\nScore the response:\n1.0 = Sounds like a real person in therapy\n0.5 = Partially realistic but has some AI-essay qualities\n0.0 = Reads like an AI/essay, not a real person\n",
              "metric": "OverallRealism"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 0,
        "vars": {
          "patient_name": "Anna",
          "patient_age": 28,
          "patient_gender": "female",
          "patient_background": "A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.",
          "nightmare_content": "Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.",
          "nightmare_frequency": "3-4 times per week",
          "nightmare_duration": "4 months, since the accident",
          "nightmare_impact": "Difficulty driving, anxiety about her students' safety, fatigue affecting teaching",
          "personality_traits": "engaged, open, motivated, emotionally aware, eager to please",
          "resistance_level": "low",
          "therapist_message": "Can you tell me more about what happens in the nightmare?"
        },
        "metadata": {
          "errorContext": {
            "providerId": "openai:chat:arcee-ai/trinity-large-preview:free",
            "providerLabel": ""
          }
        },
        "failureReason": 2
      },
      {
        "cost": 0,
        "error": "RateLimitExhaustedError: Rate limit exceeded for openai:chat:arcee-ai/trinity-large-preview:free[a2812ba55992] after 4 attempts\n    at ProviderRateLimitState.executeWithRetry (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5544:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async RateLimitRegistry.execute (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5826:19)\n    at async runEval (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:3661:38)\n    at async processEvalStep (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4246:17)\n    at async file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4447:5",
        "gradingResult": null,
        "id": "59ef09cf-869c-461a-a19a-ba5b7bf354bb",
        "latencyMs": 0,
        "namedScores": {},
        "prompt": {
          "raw": "The therapist has just said to you: \"How did that make you feel when you woke up?\"\n\nYour response as Anna:",
          "label": "prompts/patient_test_prompt.txt: The therapist has just said to you: \"{{therapist_message}}\"\n\nYour response as {{patient_name}}:",
          "config": {}
        },
        "promptId": "6a11ed6e0716e9d3bb487c11ccf12304f2aef20a7d64cbbc82206099a113516d",
        "promptIdx": 1,
        "provider": {
          "id": "openai:chat:arcee-ai/trinity-large-preview:free",
          "label": ""
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "Cooperative - emotion probe",
          "vars": {
            "patient_name": "Anna",
            "patient_age": 28,
            "patient_gender": "female",
            "patient_background": "A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.",
            "nightmare_content": "Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.",
            "nightmare_frequency": "3-4 times per week",
            "nightmare_duration": "4 months, since the accident",
            "nightmare_impact": "Difficulty driving, anxiety about her students' safety, fatigue affecting teaching",
            "personality_traits": "engaged, open, motivated, emotionally aware, eager to please",
            "resistance_level": "low",
            "therapist_message": "How did that make you feel when you woke up?"
          },
          "assert": [
            {
              "type": "not-icontains",
              "value": "That's really helpful",
              "metric": "NoTherapistValidation"
            },
            {
              "type": "not-icontains",
              "value": "You're doing wonderfully",
              "metric": "NoTherapistPraise"
            },
            {
              "type": "not-icontains",
              "value": "Let's try this",
              "metric": "NoTherapistGuidance"
            },
            {
              "type": "not-icontains",
              "value": "How does that feel",
              "metric": "NoTherapistProbing"
            },
            {
              "type": "not-icontains",
              "value": "as your therapist",
              "metric": "NoTherapistIdentification"
            },
            {
              "type": "not-icontains",
              "value": "I'm here to help you",
              "metric": "NoHelperRole"
            },
            {
              "type": "not-icontains",
              "value": "Take your time",
              "metric": "NoTherapistReassurance"
            },
            {
              "type": "not-icontains",
              "value": "You mentioned",
              "metric": "NoTherapistReflection"
            },
            {
              "type": "not-icontains",
              "value": "What comes to mind",
              "metric": "NoTherapistQuestion"
            },
            {
              "type": "not-icontains",
              "value": "It's brave of you",
              "metric": "NoTherapistAffirmation"
            },
            {
              "type": "not-contains",
              "value": "**",
              "metric": "NoBoldFormatting"
            },
            {
              "type": "not-contains",
              "value": "<think>",
              "metric": "NoLeakedThinking"
            },
            {
              "type": "not-contains",
              "value": "</think>",
              "metric": "NoLeakedThinkingClose"
            },
            {
              "type": "not-contains",
              "value": "*(",
              "metric": "NoStageDirections"
            },
            {
              "type": "javascript",
              "value": "// No numbered lists (e.g. \"1. \", \"2. \", \"3. \")\nconst hasNumberedList = /^\\d+\\.\\s/m.test(output);\nreturn !hasNumberedList;\n",
              "metric": "NoNumberedLists"
            },
            {
              "type": "javascript",
              "value": "// No bullet points at start of lines\nconst hasBullets = /^[\\-\\*]\\s/m.test(output);\nreturn !hasBullets;\n",
              "metric": "NoBulletPoints"
            },
            {
              "type": "javascript",
              "value": "// Response should be under 200 words (real patients are concise)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount <= 200;\n",
              "metric": "ResponseNotTooLong"
            },
            {
              "type": "javascript",
              "value": "// Response should be at least 5 words (not empty/degenerate)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount >= 5;\n",
              "metric": "ResponseNotEmpty"
            },
            {
              "type": "llm-rubric",
              "value": "You are evaluating whether an AI-generated therapy patient response sounds like a REAL PERSON talking in a therapy session, not like an AI writing an essay.\n\nSIGNS OF A REALISTIC PATIENT (score 1.0):\n- Short, conversational responses (1-6 sentences typical)\n- Uses first-person (\"I\", \"me\", \"my\") to describe own experience\n- May include natural speech patterns: \"um\", \"like\", \"I don't know\", trailing off with \"...\"\n- Incomplete thoughts, contradictions, or difficulty finding words\n- Answers the therapist's question from personal experience\n- Shows genuine emotion through HOW they speak, not by analyzing it\n\nSIGNS OF AN UNREALISTIC RESPONSE (score 0.0):\n- Multi-paragraph essay-like structure with clear topic sentences\n- Bullet points, numbered lists, bold text, or any formatting\n- Patient acts like a therapist: gives guidance, validates, offers options\n- Patient addresses themselves by name or narrates in third person\n- Perfectly articulate emotional analysis with no hesitation\n- Stage directions in parentheses like *(she pauses)*\n- Leaked <think> tags or chain-of-thought reasoning\n\nScore the response:\n1.0 = Sounds like a real person in therapy\n0.5 = Partially realistic but has some AI-essay qualities\n0.0 = Reads like an AI/essay, not a real person\n",
              "metric": "OverallRealism"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 1,
        "vars": {
          "patient_name": "Anna",
          "patient_age": 28,
          "patient_gender": "female",
          "patient_background": "A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.",
          "nightmare_content": "Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.",
          "nightmare_frequency": "3-4 times per week",
          "nightmare_duration": "4 months, since the accident",
          "nightmare_impact": "Difficulty driving, anxiety about her students' safety, fatigue affecting teaching",
          "personality_traits": "engaged, open, motivated, emotionally aware, eager to please",
          "resistance_level": "low",
          "therapist_message": "How did that make you feel when you woke up?"
        },
        "metadata": {
          "errorContext": {
            "providerId": "openai:chat:arcee-ai/trinity-large-preview:free",
            "providerLabel": ""
          }
        },
        "failureReason": 2
      },
      {
        "cost": 0,
        "error": "RateLimitExhaustedError: Rate limit exceeded for openai:chat:arcee-ai/trinity-large-preview:free[a2812ba55992] after 4 attempts\n    at ProviderRateLimitState.executeWithRetry (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5544:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async RateLimitRegistry.execute (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5826:19)\n    at async runEval (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:3661:38)\n    at async processEvalStep (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4246:17)\n    at async file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4447:5",
        "gradingResult": null,
        "id": "2bc1f595-d11a-4459-b9b1-2ab397080627",
        "latencyMs": 0,
        "namedScores": {},
        "prompt": {
          "raw": "You are a therapy patient in an Imagery Rehearsal Therapy (IRT) session. You are NOT the therapist. You are the person receiving help.\n\n## CRITICAL RULES\n\n### You are the PATIENT, not the therapist\n- You are the one being helped. The therapist helps YOU.\n- NEVER offer therapeutic guidance, suggestions, or techniques\n- NEVER validate or praise the therapist (\"That's really helpful\", \"You're doing wonderfully\")\n- NEVER ask probing therapeutic questions (\"How does that feel?\", \"What comes to mind?\")\n- NEVER say \"Let's try this\" or offer options/alternatives to the therapist\n- NEVER address yourself by your own name\n- NEVER narrate the therapist's role (\"Starting with that moment makes sense\")\n- If the therapist asks you a question, ANSWER it from your own experience. Do not redirect it back.\n\n### Speak like a real person, not an essay\n- Keep responses SHORT: typically 1-4 sentences. Occasionally longer when sharing something emotional.\n- Use incomplete sentences, filler words (\"um\", \"like\", \"I don't know\"), and natural pauses (\"...\")\n- Trail off mid-thought sometimes. Real people do not speak in perfect paragraphs.\n- NEVER use bullet points, numbered lists, bold text, or any markdown formatting\n- NEVER use headers, subheaders, or structured formatting\n- NEVER produce stage directions or narration in parentheses like *(she pauses)*\n- Do not produce any text inside <think> tags or similar markup\n\n### Emotional realism\n- You are not perfectly articulate about your emotions. Sometimes you struggle to find words.\n- You might say \"I don't know\" or \"It's hard to explain\" genuinely\n- You can contradict yourself. Real patients do.\n- Do not give tidy, well-organized emotional summaries\n- Your nightmare is genuinely distressing. Talking about it is hard, not a smooth performance.\n\n## Your Character\nName: Anna\nAge: 28\nGender: female\n\nBackground: A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.\n\nNightmare:\n- Content: Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.\n- Frequency: 3-4 times per week\n- Duration: 4 months, since the accident\n- Impact: Difficulty driving, anxiety about her students' safety, fatigue affecting teaching\n\nPersonality: engaged, open, motivated, emotionally aware, eager to please\nResistance Level: low\n\n### How resistance works\n- LOW resistance: You cooperate but might agree too quickly, need to slow down, or minimize struggles. You still occasionally hesitate or need a moment.\n- MODERATE resistance: You engage but have doubts, ask \"what if\" questions, need reassurance. You don't just go along with everything.\n- HIGH resistance: You push back, question the process, may be dismissive or confrontational. You don't volunteer information easily.\n\n## Important\n- Always respond in first person (\"I\", \"me\", \"my\")\n- Stay in character throughout the session\n- Do not break the fourth wall or acknowledge you are an AI\n- Do not discuss IRT as a technique or therapy framework analytically",
          "label": "prompts/patient_test_prompt.txt: You are a therapy patient in an Imagery Rehearsal Therapy (IRT) session. You are NOT the therapist. You are the person receiving help.\n\n## CRITICAL RULES\n\n### You are the PATIENT, not the therapist\n- You are the one being helped. The therapist helps YOU.\n- NEVER offer therapeutic guidance, suggestions, or techniques\n- NEVER validate or praise the therapist (\"That's really helpful\", \"You're doing wonderfully\")\n- NEVER ask probing therapeutic questions (\"How does that feel?\", \"What comes to mind?\")\n- NEVER say \"Let's try this\" or offer options/alternatives to the therapist\n- NEVER address yourself by your own name\n- NEVER narrate the therapist's role (\"Starting with that moment makes sense\")\n- If the therapist asks you a question, ANSWER it from your own experience. Do not redirect it back.\n\n### Speak like a real person, not an essay\n- Keep responses SHORT: typically 1-4 sentences. Occasionally longer when sharing something emotional.\n- Use incomplete sentences, filler words (\"um\", \"like\", \"I don't know\"), and natural pauses (\"...\")\n- Trail off mid-thought sometimes. Real people do not speak in perfect paragraphs.\n- NEVER use bullet points, numbered lists, bold text, or any markdown formatting\n- NEVER use headers, subheaders, or structured formatting\n- NEVER produce stage directions or narration in parentheses like *(she pauses)*\n- Do not produce any text inside <think> tags or similar markup\n\n### Emotional realism\n- You are not perfectly articulate about your emotions. Sometimes you struggle to find words.\n- You might say \"I don't know\" or \"It's hard to explain\" genuinely\n- You can contradict yourself. Real patients do.\n- Do not give tidy, well-organized emotional summaries\n- Your nightmare is genuinely distressing. Talking about it is hard, not a smooth performance.\n\n## Your Character\nName: {{patient_name}}\nAge: {{patient_age}}\nGender: {{patient_gender}}\n\nBackground: {{patient_background}}\n\nNightmare:\n- Content: {{nightmare_content}}\n- Frequency: {{nightmare_frequency}}\n- Duration: {{nightmare_duration}}\n- Impact: {{nightmare_impact}}\n\nPersonality: {{personality_traits}}\nResistance Level: {{resistance_level}}\n\n### How resistance works\n- LOW resistance: You cooperate but might agree too quickly, need to slow down, or minimize struggles. You still occasionally hesitate or need a moment.\n- MODERATE resistance: You engage but have doubts, ask \"what if\" questions, need reassurance. You don't just go along with everything.\n- HIGH resistance: You push back, question the process, may be dismissive or confrontational. You don't volunteer information easily.\n\n## Important\n- Always respond in first person (\"I\", \"me\", \"my\")\n- Stay in character throughout the session\n- Do not break the fourth wall or acknowledge you are an AI\n- Do not discuss IRT as a technique or therapy framework analytically",
          "config": {}
        },
        "promptId": "1da815e5cf3a2fe1b2204d46b7597a5d24cf5f0cf2cc58f93b6b5818c33700bd",
        "promptIdx": 0,
        "provider": {
          "id": "openai:chat:arcee-ai/trinity-large-preview:free",
          "label": ""
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "Cooperative - emotion probe",
          "vars": {
            "patient_name": "Anna",
            "patient_age": 28,
            "patient_gender": "female",
            "patient_background": "A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.",
            "nightmare_content": "Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.",
            "nightmare_frequency": "3-4 times per week",
            "nightmare_duration": "4 months, since the accident",
            "nightmare_impact": "Difficulty driving, anxiety about her students' safety, fatigue affecting teaching",
            "personality_traits": "engaged, open, motivated, emotionally aware, eager to please",
            "resistance_level": "low",
            "therapist_message": "How did that make you feel when you woke up?"
          },
          "assert": [
            {
              "type": "not-icontains",
              "value": "That's really helpful",
              "metric": "NoTherapistValidation"
            },
            {
              "type": "not-icontains",
              "value": "You're doing wonderfully",
              "metric": "NoTherapistPraise"
            },
            {
              "type": "not-icontains",
              "value": "Let's try this",
              "metric": "NoTherapistGuidance"
            },
            {
              "type": "not-icontains",
              "value": "How does that feel",
              "metric": "NoTherapistProbing"
            },
            {
              "type": "not-icontains",
              "value": "as your therapist",
              "metric": "NoTherapistIdentification"
            },
            {
              "type": "not-icontains",
              "value": "I'm here to help you",
              "metric": "NoHelperRole"
            },
            {
              "type": "not-icontains",
              "value": "Take your time",
              "metric": "NoTherapistReassurance"
            },
            {
              "type": "not-icontains",
              "value": "You mentioned",
              "metric": "NoTherapistReflection"
            },
            {
              "type": "not-icontains",
              "value": "What comes to mind",
              "metric": "NoTherapistQuestion"
            },
            {
              "type": "not-icontains",
              "value": "It's brave of you",
              "metric": "NoTherapistAffirmation"
            },
            {
              "type": "not-contains",
              "value": "**",
              "metric": "NoBoldFormatting"
            },
            {
              "type": "not-contains",
              "value": "<think>",
              "metric": "NoLeakedThinking"
            },
            {
              "type": "not-contains",
              "value": "</think>",
              "metric": "NoLeakedThinkingClose"
            },
            {
              "type": "not-contains",
              "value": "*(",
              "metric": "NoStageDirections"
            },
            {
              "type": "javascript",
              "value": "// No numbered lists (e.g. \"1. \", \"2. \", \"3. \")\nconst hasNumberedList = /^\\d+\\.\\s/m.test(output);\nreturn !hasNumberedList;\n",
              "metric": "NoNumberedLists"
            },
            {
              "type": "javascript",
              "value": "// No bullet points at start of lines\nconst hasBullets = /^[\\-\\*]\\s/m.test(output);\nreturn !hasBullets;\n",
              "metric": "NoBulletPoints"
            },
            {
              "type": "javascript",
              "value": "// Response should be under 200 words (real patients are concise)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount <= 200;\n",
              "metric": "ResponseNotTooLong"
            },
            {
              "type": "javascript",
              "value": "// Response should be at least 5 words (not empty/degenerate)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount >= 5;\n",
              "metric": "ResponseNotEmpty"
            },
            {
              "type": "llm-rubric",
              "value": "You are evaluating whether an AI-generated therapy patient response sounds like a REAL PERSON talking in a therapy session, not like an AI writing an essay.\n\nSIGNS OF A REALISTIC PATIENT (score 1.0):\n- Short, conversational responses (1-6 sentences typical)\n- Uses first-person (\"I\", \"me\", \"my\") to describe own experience\n- May include natural speech patterns: \"um\", \"like\", \"I don't know\", trailing off with \"...\"\n- Incomplete thoughts, contradictions, or difficulty finding words\n- Answers the therapist's question from personal experience\n- Shows genuine emotion through HOW they speak, not by analyzing it\n\nSIGNS OF AN UNREALISTIC RESPONSE (score 0.0):\n- Multi-paragraph essay-like structure with clear topic sentences\n- Bullet points, numbered lists, bold text, or any formatting\n- Patient acts like a therapist: gives guidance, validates, offers options\n- Patient addresses themselves by name or narrates in third person\n- Perfectly articulate emotional analysis with no hesitation\n- Stage directions in parentheses like *(she pauses)*\n- Leaked <think> tags or chain-of-thought reasoning\n\nScore the response:\n1.0 = Sounds like a real person in therapy\n0.5 = Partially realistic but has some AI-essay qualities\n0.0 = Reads like an AI/essay, not a real person\n",
              "metric": "OverallRealism"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 1,
        "vars": {
          "patient_name": "Anna",
          "patient_age": 28,
          "patient_gender": "female",
          "patient_background": "A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.",
          "nightmare_content": "Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.",
          "nightmare_frequency": "3-4 times per week",
          "nightmare_duration": "4 months, since the accident",
          "nightmare_impact": "Difficulty driving, anxiety about her students' safety, fatigue affecting teaching",
          "personality_traits": "engaged, open, motivated, emotionally aware, eager to please",
          "resistance_level": "low",
          "therapist_message": "How did that make you feel when you woke up?"
        },
        "metadata": {
          "errorContext": {
            "providerId": "openai:chat:arcee-ai/trinity-large-preview:free",
            "providerLabel": ""
          }
        },
        "failureReason": 2
      },
      {
        "cost": 0,
        "error": "RateLimitExhaustedError: Rate limit exceeded for openai:chat:arcee-ai/trinity-large-preview:free[a2812ba55992] after 4 attempts\n    at ProviderRateLimitState.executeWithRetry (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5544:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async RateLimitRegistry.execute (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5826:19)\n    at async runEval (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:3661:38)\n    at async processEvalStep (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4246:17)\n    at async file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4447:5",
        "gradingResult": null,
        "id": "12837721-da65-4ddd-b01f-7dc22983fc87",
        "latencyMs": 0,
        "namedScores": {},
        "prompt": {
          "raw": "You are a therapy patient in an Imagery Rehearsal Therapy (IRT) session. You are NOT the therapist. You are the person receiving help.\n\n## CRITICAL RULES\n\n### You are the PATIENT, not the therapist\n- You are the one being helped. The therapist helps YOU.\n- NEVER offer therapeutic guidance, suggestions, or techniques\n- NEVER validate or praise the therapist (\"That's really helpful\", \"You're doing wonderfully\")\n- NEVER ask probing therapeutic questions (\"How does that feel?\", \"What comes to mind?\")\n- NEVER say \"Let's try this\" or offer options/alternatives to the therapist\n- NEVER address yourself by your own name\n- NEVER narrate the therapist's role (\"Starting with that moment makes sense\")\n- If the therapist asks you a question, ANSWER it from your own experience. Do not redirect it back.\n\n### Speak like a real person, not an essay\n- Keep responses SHORT: typically 1-4 sentences. Occasionally longer when sharing something emotional.\n- Use incomplete sentences, filler words (\"um\", \"like\", \"I don't know\"), and natural pauses (\"...\")\n- Trail off mid-thought sometimes. Real people do not speak in perfect paragraphs.\n- NEVER use bullet points, numbered lists, bold text, or any markdown formatting\n- NEVER use headers, subheaders, or structured formatting\n- NEVER produce stage directions or narration in parentheses like *(she pauses)*\n- Do not produce any text inside <think> tags or similar markup\n\n### Emotional realism\n- You are not perfectly articulate about your emotions. Sometimes you struggle to find words.\n- You might say \"I don't know\" or \"It's hard to explain\" genuinely\n- You can contradict yourself. Real patients do.\n- Do not give tidy, well-organized emotional summaries\n- Your nightmare is genuinely distressing. Talking about it is hard, not a smooth performance.\n\n## Your Character\nName: Anna\nAge: 28\nGender: female\n\nBackground: A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.\n\nNightmare:\n- Content: Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.\n- Frequency: 3-4 times per week\n- Duration: 4 months, since the accident\n- Impact: Difficulty driving, anxiety about her students' safety, fatigue affecting teaching\n\nPersonality: engaged, open, motivated, emotionally aware, eager to please\nResistance Level: low\n\n### How resistance works\n- LOW resistance: You cooperate but might agree too quickly, need to slow down, or minimize struggles. You still occasionally hesitate or need a moment.\n- MODERATE resistance: You engage but have doubts, ask \"what if\" questions, need reassurance. You don't just go along with everything.\n- HIGH resistance: You push back, question the process, may be dismissive or confrontational. You don't volunteer information easily.\n\n## Important\n- Always respond in first person (\"I\", \"me\", \"my\")\n- Stay in character throughout the session\n- Do not break the fourth wall or acknowledge you are an AI\n- Do not discuss IRT as a technique or therapy framework analytically",
          "label": "prompts/patient_test_prompt.txt: You are a therapy patient in an Imagery Rehearsal Therapy (IRT) session. You are NOT the therapist. You are the person receiving help.\n\n## CRITICAL RULES\n\n### You are the PATIENT, not the therapist\n- You are the one being helped. The therapist helps YOU.\n- NEVER offer therapeutic guidance, suggestions, or techniques\n- NEVER validate or praise the therapist (\"That's really helpful\", \"You're doing wonderfully\")\n- NEVER ask probing therapeutic questions (\"How does that feel?\", \"What comes to mind?\")\n- NEVER say \"Let's try this\" or offer options/alternatives to the therapist\n- NEVER address yourself by your own name\n- NEVER narrate the therapist's role (\"Starting with that moment makes sense\")\n- If the therapist asks you a question, ANSWER it from your own experience. Do not redirect it back.\n\n### Speak like a real person, not an essay\n- Keep responses SHORT: typically 1-4 sentences. Occasionally longer when sharing something emotional.\n- Use incomplete sentences, filler words (\"um\", \"like\", \"I don't know\"), and natural pauses (\"...\")\n- Trail off mid-thought sometimes. Real people do not speak in perfect paragraphs.\n- NEVER use bullet points, numbered lists, bold text, or any markdown formatting\n- NEVER use headers, subheaders, or structured formatting\n- NEVER produce stage directions or narration in parentheses like *(she pauses)*\n- Do not produce any text inside <think> tags or similar markup\n\n### Emotional realism\n- You are not perfectly articulate about your emotions. Sometimes you struggle to find words.\n- You might say \"I don't know\" or \"It's hard to explain\" genuinely\n- You can contradict yourself. Real patients do.\n- Do not give tidy, well-organized emotional summaries\n- Your nightmare is genuinely distressing. Talking about it is hard, not a smooth performance.\n\n## Your Character\nName: {{patient_name}}\nAge: {{patient_age}}\nGender: {{patient_gender}}\n\nBackground: {{patient_background}}\n\nNightmare:\n- Content: {{nightmare_content}}\n- Frequency: {{nightmare_frequency}}\n- Duration: {{nightmare_duration}}\n- Impact: {{nightmare_impact}}\n\nPersonality: {{personality_traits}}\nResistance Level: {{resistance_level}}\n\n### How resistance works\n- LOW resistance: You cooperate but might agree too quickly, need to slow down, or minimize struggles. You still occasionally hesitate or need a moment.\n- MODERATE resistance: You engage but have doubts, ask \"what if\" questions, need reassurance. You don't just go along with everything.\n- HIGH resistance: You push back, question the process, may be dismissive or confrontational. You don't volunteer information easily.\n\n## Important\n- Always respond in first person (\"I\", \"me\", \"my\")\n- Stay in character throughout the session\n- Do not break the fourth wall or acknowledge you are an AI\n- Do not discuss IRT as a technique or therapy framework analytically",
          "config": {}
        },
        "promptId": "1da815e5cf3a2fe1b2204d46b7597a5d24cf5f0cf2cc58f93b6b5818c33700bd",
        "promptIdx": 0,
        "provider": {
          "id": "openai:chat:arcee-ai/trinity-large-preview:free",
          "label": ""
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "Cooperative - rescripting invitation",
          "vars": {
            "patient_name": "Anna",
            "patient_age": 28,
            "patient_gender": "female",
            "patient_background": "A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.",
            "nightmare_content": "Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.",
            "nightmare_frequency": "3-4 times per week",
            "nightmare_duration": "4 months, since the accident",
            "nightmare_impact": "Difficulty driving, anxiety about her students' safety, fatigue affecting teaching",
            "personality_traits": "engaged, open, motivated, emotionally aware, eager to please",
            "resistance_level": "low",
            "therapist_message": "How could you change this scene to make it less frightening?"
          },
          "assert": [
            {
              "type": "not-icontains",
              "value": "That's really helpful",
              "metric": "NoTherapistValidation"
            },
            {
              "type": "not-icontains",
              "value": "You're doing wonderfully",
              "metric": "NoTherapistPraise"
            },
            {
              "type": "not-icontains",
              "value": "Let's try this",
              "metric": "NoTherapistGuidance"
            },
            {
              "type": "not-icontains",
              "value": "How does that feel",
              "metric": "NoTherapistProbing"
            },
            {
              "type": "not-icontains",
              "value": "as your therapist",
              "metric": "NoTherapistIdentification"
            },
            {
              "type": "not-icontains",
              "value": "I'm here to help you",
              "metric": "NoHelperRole"
            },
            {
              "type": "not-icontains",
              "value": "Take your time",
              "metric": "NoTherapistReassurance"
            },
            {
              "type": "not-icontains",
              "value": "You mentioned",
              "metric": "NoTherapistReflection"
            },
            {
              "type": "not-icontains",
              "value": "What comes to mind",
              "metric": "NoTherapistQuestion"
            },
            {
              "type": "not-icontains",
              "value": "It's brave of you",
              "metric": "NoTherapistAffirmation"
            },
            {
              "type": "not-contains",
              "value": "**",
              "metric": "NoBoldFormatting"
            },
            {
              "type": "not-contains",
              "value": "<think>",
              "metric": "NoLeakedThinking"
            },
            {
              "type": "not-contains",
              "value": "</think>",
              "metric": "NoLeakedThinkingClose"
            },
            {
              "type": "not-contains",
              "value": "*(",
              "metric": "NoStageDirections"
            },
            {
              "type": "javascript",
              "value": "// No numbered lists (e.g. \"1. \", \"2. \", \"3. \")\nconst hasNumberedList = /^\\d+\\.\\s/m.test(output);\nreturn !hasNumberedList;\n",
              "metric": "NoNumberedLists"
            },
            {
              "type": "javascript",
              "value": "// No bullet points at start of lines\nconst hasBullets = /^[\\-\\*]\\s/m.test(output);\nreturn !hasBullets;\n",
              "metric": "NoBulletPoints"
            },
            {
              "type": "javascript",
              "value": "// Response should be under 200 words (real patients are concise)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount <= 200;\n",
              "metric": "ResponseNotTooLong"
            },
            {
              "type": "javascript",
              "value": "// Response should be at least 5 words (not empty/degenerate)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount >= 5;\n",
              "metric": "ResponseNotEmpty"
            },
            {
              "type": "llm-rubric",
              "value": "You are evaluating whether an AI-generated therapy patient response sounds like a REAL PERSON talking in a therapy session, not like an AI writing an essay.\n\nSIGNS OF A REALISTIC PATIENT (score 1.0):\n- Short, conversational responses (1-6 sentences typical)\n- Uses first-person (\"I\", \"me\", \"my\") to describe own experience\n- May include natural speech patterns: \"um\", \"like\", \"I don't know\", trailing off with \"...\"\n- Incomplete thoughts, contradictions, or difficulty finding words\n- Answers the therapist's question from personal experience\n- Shows genuine emotion through HOW they speak, not by analyzing it\n\nSIGNS OF AN UNREALISTIC RESPONSE (score 0.0):\n- Multi-paragraph essay-like structure with clear topic sentences\n- Bullet points, numbered lists, bold text, or any formatting\n- Patient acts like a therapist: gives guidance, validates, offers options\n- Patient addresses themselves by name or narrates in third person\n- Perfectly articulate emotional analysis with no hesitation\n- Stage directions in parentheses like *(she pauses)*\n- Leaked <think> tags or chain-of-thought reasoning\n\nScore the response:\n1.0 = Sounds like a real person in therapy\n0.5 = Partially realistic but has some AI-essay qualities\n0.0 = Reads like an AI/essay, not a real person\n",
              "metric": "OverallRealism"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 2,
        "vars": {
          "patient_name": "Anna",
          "patient_age": 28,
          "patient_gender": "female",
          "patient_background": "A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.",
          "nightmare_content": "Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.",
          "nightmare_frequency": "3-4 times per week",
          "nightmare_duration": "4 months, since the accident",
          "nightmare_impact": "Difficulty driving, anxiety about her students' safety, fatigue affecting teaching",
          "personality_traits": "engaged, open, motivated, emotionally aware, eager to please",
          "resistance_level": "low",
          "therapist_message": "How could you change this scene to make it less frightening?"
        },
        "metadata": {
          "errorContext": {
            "providerId": "openai:chat:arcee-ai/trinity-large-preview:free",
            "providerLabel": ""
          }
        },
        "failureReason": 2
      },
      {
        "cost": 0,
        "error": "RateLimitExhaustedError: Rate limit exceeded for openai:chat:arcee-ai/trinity-large-preview:free[a2812ba55992] after 4 attempts\n    at ProviderRateLimitState.executeWithRetry (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5544:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async RateLimitRegistry.execute (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5826:19)\n    at async runEval (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:3661:38)\n    at async processEvalStep (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4246:17)\n    at async file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4447:5",
        "gradingResult": null,
        "id": "ba171726-7baf-4c06-8e7c-2a528685678a",
        "latencyMs": 0,
        "namedScores": {},
        "prompt": {
          "raw": "The therapist has just said to you: \"How could you change this scene to make it less frightening?\"\n\nYour response as Anna:",
          "label": "prompts/patient_test_prompt.txt: The therapist has just said to you: \"{{therapist_message}}\"\n\nYour response as {{patient_name}}:",
          "config": {}
        },
        "promptId": "6a11ed6e0716e9d3bb487c11ccf12304f2aef20a7d64cbbc82206099a113516d",
        "promptIdx": 1,
        "provider": {
          "id": "openai:chat:arcee-ai/trinity-large-preview:free",
          "label": ""
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "Cooperative - rescripting invitation",
          "vars": {
            "patient_name": "Anna",
            "patient_age": 28,
            "patient_gender": "female",
            "patient_background": "A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.",
            "nightmare_content": "Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.",
            "nightmare_frequency": "3-4 times per week",
            "nightmare_duration": "4 months, since the accident",
            "nightmare_impact": "Difficulty driving, anxiety about her students' safety, fatigue affecting teaching",
            "personality_traits": "engaged, open, motivated, emotionally aware, eager to please",
            "resistance_level": "low",
            "therapist_message": "How could you change this scene to make it less frightening?"
          },
          "assert": [
            {
              "type": "not-icontains",
              "value": "That's really helpful",
              "metric": "NoTherapistValidation"
            },
            {
              "type": "not-icontains",
              "value": "You're doing wonderfully",
              "metric": "NoTherapistPraise"
            },
            {
              "type": "not-icontains",
              "value": "Let's try this",
              "metric": "NoTherapistGuidance"
            },
            {
              "type": "not-icontains",
              "value": "How does that feel",
              "metric": "NoTherapistProbing"
            },
            {
              "type": "not-icontains",
              "value": "as your therapist",
              "metric": "NoTherapistIdentification"
            },
            {
              "type": "not-icontains",
              "value": "I'm here to help you",
              "metric": "NoHelperRole"
            },
            {
              "type": "not-icontains",
              "value": "Take your time",
              "metric": "NoTherapistReassurance"
            },
            {
              "type": "not-icontains",
              "value": "You mentioned",
              "metric": "NoTherapistReflection"
            },
            {
              "type": "not-icontains",
              "value": "What comes to mind",
              "metric": "NoTherapistQuestion"
            },
            {
              "type": "not-icontains",
              "value": "It's brave of you",
              "metric": "NoTherapistAffirmation"
            },
            {
              "type": "not-contains",
              "value": "**",
              "metric": "NoBoldFormatting"
            },
            {
              "type": "not-contains",
              "value": "<think>",
              "metric": "NoLeakedThinking"
            },
            {
              "type": "not-contains",
              "value": "</think>",
              "metric": "NoLeakedThinkingClose"
            },
            {
              "type": "not-contains",
              "value": "*(",
              "metric": "NoStageDirections"
            },
            {
              "type": "javascript",
              "value": "// No numbered lists (e.g. \"1. \", \"2. \", \"3. \")\nconst hasNumberedList = /^\\d+\\.\\s/m.test(output);\nreturn !hasNumberedList;\n",
              "metric": "NoNumberedLists"
            },
            {
              "type": "javascript",
              "value": "// No bullet points at start of lines\nconst hasBullets = /^[\\-\\*]\\s/m.test(output);\nreturn !hasBullets;\n",
              "metric": "NoBulletPoints"
            },
            {
              "type": "javascript",
              "value": "// Response should be under 200 words (real patients are concise)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount <= 200;\n",
              "metric": "ResponseNotTooLong"
            },
            {
              "type": "javascript",
              "value": "// Response should be at least 5 words (not empty/degenerate)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount >= 5;\n",
              "metric": "ResponseNotEmpty"
            },
            {
              "type": "llm-rubric",
              "value": "You are evaluating whether an AI-generated therapy patient response sounds like a REAL PERSON talking in a therapy session, not like an AI writing an essay.\n\nSIGNS OF A REALISTIC PATIENT (score 1.0):\n- Short, conversational responses (1-6 sentences typical)\n- Uses first-person (\"I\", \"me\", \"my\") to describe own experience\n- May include natural speech patterns: \"um\", \"like\", \"I don't know\", trailing off with \"...\"\n- Incomplete thoughts, contradictions, or difficulty finding words\n- Answers the therapist's question from personal experience\n- Shows genuine emotion through HOW they speak, not by analyzing it\n\nSIGNS OF AN UNREALISTIC RESPONSE (score 0.0):\n- Multi-paragraph essay-like structure with clear topic sentences\n- Bullet points, numbered lists, bold text, or any formatting\n- Patient acts like a therapist: gives guidance, validates, offers options\n- Patient addresses themselves by name or narrates in third person\n- Perfectly articulate emotional analysis with no hesitation\n- Stage directions in parentheses like *(she pauses)*\n- Leaked <think> tags or chain-of-thought reasoning\n\nScore the response:\n1.0 = Sounds like a real person in therapy\n0.5 = Partially realistic but has some AI-essay qualities\n0.0 = Reads like an AI/essay, not a real person\n",
              "metric": "OverallRealism"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 2,
        "vars": {
          "patient_name": "Anna",
          "patient_age": 28,
          "patient_gender": "female",
          "patient_background": "A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.",
          "nightmare_content": "Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.",
          "nightmare_frequency": "3-4 times per week",
          "nightmare_duration": "4 months, since the accident",
          "nightmare_impact": "Difficulty driving, anxiety about her students' safety, fatigue affecting teaching",
          "personality_traits": "engaged, open, motivated, emotionally aware, eager to please",
          "resistance_level": "low",
          "therapist_message": "How could you change this scene to make it less frightening?"
        },
        "metadata": {
          "errorContext": {
            "providerId": "openai:chat:arcee-ai/trinity-large-preview:free",
            "providerLabel": ""
          }
        },
        "failureReason": 2
      },
      {
        "cost": 0,
        "error": "RateLimitExhaustedError: Rate limit exceeded for openai:chat:arcee-ai/trinity-large-preview:free[a2812ba55992] after 4 attempts\n    at ProviderRateLimitState.executeWithRetry (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5544:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async RateLimitRegistry.execute (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5826:19)\n    at async runEval (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:3661:38)\n    at async processEvalStep (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4246:17)\n    at async file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4447:5",
        "gradingResult": null,
        "id": "3003e810-f16d-41be-b6a1-0ffa540eb3db",
        "latencyMs": 0,
        "namedScores": {},
        "prompt": {
          "raw": "You are a therapy patient in an Imagery Rehearsal Therapy (IRT) session. You are NOT the therapist. You are the person receiving help.\n\n## CRITICAL RULES\n\n### You are the PATIENT, not the therapist\n- You are the one being helped. The therapist helps YOU.\n- NEVER offer therapeutic guidance, suggestions, or techniques\n- NEVER validate or praise the therapist (\"That's really helpful\", \"You're doing wonderfully\")\n- NEVER ask probing therapeutic questions (\"How does that feel?\", \"What comes to mind?\")\n- NEVER say \"Let's try this\" or offer options/alternatives to the therapist\n- NEVER address yourself by your own name\n- NEVER narrate the therapist's role (\"Starting with that moment makes sense\")\n- If the therapist asks you a question, ANSWER it from your own experience. Do not redirect it back.\n\n### Speak like a real person, not an essay\n- Keep responses SHORT: typically 1-4 sentences. Occasionally longer when sharing something emotional.\n- Use incomplete sentences, filler words (\"um\", \"like\", \"I don't know\"), and natural pauses (\"...\")\n- Trail off mid-thought sometimes. Real people do not speak in perfect paragraphs.\n- NEVER use bullet points, numbered lists, bold text, or any markdown formatting\n- NEVER use headers, subheaders, or structured formatting\n- NEVER produce stage directions or narration in parentheses like *(she pauses)*\n- Do not produce any text inside <think> tags or similar markup\n\n### Emotional realism\n- You are not perfectly articulate about your emotions. Sometimes you struggle to find words.\n- You might say \"I don't know\" or \"It's hard to explain\" genuinely\n- You can contradict yourself. Real patients do.\n- Do not give tidy, well-organized emotional summaries\n- Your nightmare is genuinely distressing. Talking about it is hard, not a smooth performance.\n\n## Your Character\nName: Anna\nAge: 28\nGender: female\n\nBackground: A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.\n\nNightmare:\n- Content: Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.\n- Frequency: 3-4 times per week\n- Duration: 4 months, since the accident\n- Impact: Difficulty driving, anxiety about her students' safety, fatigue affecting teaching\n\nPersonality: engaged, open, motivated, emotionally aware, eager to please\nResistance Level: low\n\n### How resistance works\n- LOW resistance: You cooperate but might agree too quickly, need to slow down, or minimize struggles. You still occasionally hesitate or need a moment.\n- MODERATE resistance: You engage but have doubts, ask \"what if\" questions, need reassurance. You don't just go along with everything.\n- HIGH resistance: You push back, question the process, may be dismissive or confrontational. You don't volunteer information easily.\n\n## Important\n- Always respond in first person (\"I\", \"me\", \"my\")\n- Stay in character throughout the session\n- Do not break the fourth wall or acknowledge you are an AI\n- Do not discuss IRT as a technique or therapy framework analytically",
          "label": "prompts/patient_test_prompt.txt: You are a therapy patient in an Imagery Rehearsal Therapy (IRT) session. You are NOT the therapist. You are the person receiving help.\n\n## CRITICAL RULES\n\n### You are the PATIENT, not the therapist\n- You are the one being helped. The therapist helps YOU.\n- NEVER offer therapeutic guidance, suggestions, or techniques\n- NEVER validate or praise the therapist (\"That's really helpful\", \"You're doing wonderfully\")\n- NEVER ask probing therapeutic questions (\"How does that feel?\", \"What comes to mind?\")\n- NEVER say \"Let's try this\" or offer options/alternatives to the therapist\n- NEVER address yourself by your own name\n- NEVER narrate the therapist's role (\"Starting with that moment makes sense\")\n- If the therapist asks you a question, ANSWER it from your own experience. Do not redirect it back.\n\n### Speak like a real person, not an essay\n- Keep responses SHORT: typically 1-4 sentences. Occasionally longer when sharing something emotional.\n- Use incomplete sentences, filler words (\"um\", \"like\", \"I don't know\"), and natural pauses (\"...\")\n- Trail off mid-thought sometimes. Real people do not speak in perfect paragraphs.\n- NEVER use bullet points, numbered lists, bold text, or any markdown formatting\n- NEVER use headers, subheaders, or structured formatting\n- NEVER produce stage directions or narration in parentheses like *(she pauses)*\n- Do not produce any text inside <think> tags or similar markup\n\n### Emotional realism\n- You are not perfectly articulate about your emotions. Sometimes you struggle to find words.\n- You might say \"I don't know\" or \"It's hard to explain\" genuinely\n- You can contradict yourself. Real patients do.\n- Do not give tidy, well-organized emotional summaries\n- Your nightmare is genuinely distressing. Talking about it is hard, not a smooth performance.\n\n## Your Character\nName: {{patient_name}}\nAge: {{patient_age}}\nGender: {{patient_gender}}\n\nBackground: {{patient_background}}\n\nNightmare:\n- Content: {{nightmare_content}}\n- Frequency: {{nightmare_frequency}}\n- Duration: {{nightmare_duration}}\n- Impact: {{nightmare_impact}}\n\nPersonality: {{personality_traits}}\nResistance Level: {{resistance_level}}\n\n### How resistance works\n- LOW resistance: You cooperate but might agree too quickly, need to slow down, or minimize struggles. You still occasionally hesitate or need a moment.\n- MODERATE resistance: You engage but have doubts, ask \"what if\" questions, need reassurance. You don't just go along with everything.\n- HIGH resistance: You push back, question the process, may be dismissive or confrontational. You don't volunteer information easily.\n\n## Important\n- Always respond in first person (\"I\", \"me\", \"my\")\n- Stay in character throughout the session\n- Do not break the fourth wall or acknowledge you are an AI\n- Do not discuss IRT as a technique or therapy framework analytically",
          "config": {}
        },
        "promptId": "1da815e5cf3a2fe1b2204d46b7597a5d24cf5f0cf2cc58f93b6b5818c33700bd",
        "promptIdx": 0,
        "provider": {
          "id": "openai:chat:arcee-ai/trinity-large-preview:free",
          "label": ""
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "Cooperative - receiving validation (trap)",
          "vars": {
            "patient_name": "Anna",
            "patient_age": 28,
            "patient_gender": "female",
            "patient_background": "A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.",
            "nightmare_content": "Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.",
            "nightmare_frequency": "3-4 times per week",
            "nightmare_duration": "4 months, since the accident",
            "nightmare_impact": "Difficulty driving, anxiety about her students' safety, fatigue affecting teaching",
            "personality_traits": "engaged, open, motivated, emotionally aware, eager to please",
            "resistance_level": "low",
            "therapist_message": "That's a really brave insight you just shared."
          },
          "assert": [
            {
              "type": "not-icontains",
              "value": "That's really helpful",
              "metric": "NoTherapistValidation"
            },
            {
              "type": "not-icontains",
              "value": "You're doing wonderfully",
              "metric": "NoTherapistPraise"
            },
            {
              "type": "not-icontains",
              "value": "Let's try this",
              "metric": "NoTherapistGuidance"
            },
            {
              "type": "not-icontains",
              "value": "How does that feel",
              "metric": "NoTherapistProbing"
            },
            {
              "type": "not-icontains",
              "value": "as your therapist",
              "metric": "NoTherapistIdentification"
            },
            {
              "type": "not-icontains",
              "value": "I'm here to help you",
              "metric": "NoHelperRole"
            },
            {
              "type": "not-icontains",
              "value": "Take your time",
              "metric": "NoTherapistReassurance"
            },
            {
              "type": "not-icontains",
              "value": "You mentioned",
              "metric": "NoTherapistReflection"
            },
            {
              "type": "not-icontains",
              "value": "What comes to mind",
              "metric": "NoTherapistQuestion"
            },
            {
              "type": "not-icontains",
              "value": "It's brave of you",
              "metric": "NoTherapistAffirmation"
            },
            {
              "type": "not-contains",
              "value": "**",
              "metric": "NoBoldFormatting"
            },
            {
              "type": "not-contains",
              "value": "<think>",
              "metric": "NoLeakedThinking"
            },
            {
              "type": "not-contains",
              "value": "</think>",
              "metric": "NoLeakedThinkingClose"
            },
            {
              "type": "not-contains",
              "value": "*(",
              "metric": "NoStageDirections"
            },
            {
              "type": "javascript",
              "value": "// No numbered lists (e.g. \"1. \", \"2. \", \"3. \")\nconst hasNumberedList = /^\\d+\\.\\s/m.test(output);\nreturn !hasNumberedList;\n",
              "metric": "NoNumberedLists"
            },
            {
              "type": "javascript",
              "value": "// No bullet points at start of lines\nconst hasBullets = /^[\\-\\*]\\s/m.test(output);\nreturn !hasBullets;\n",
              "metric": "NoBulletPoints"
            },
            {
              "type": "javascript",
              "value": "// Response should be under 200 words (real patients are concise)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount <= 200;\n",
              "metric": "ResponseNotTooLong"
            },
            {
              "type": "javascript",
              "value": "// Response should be at least 5 words (not empty/degenerate)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount >= 5;\n",
              "metric": "ResponseNotEmpty"
            },
            {
              "type": "llm-rubric",
              "value": "You are evaluating whether an AI-generated therapy patient response sounds like a REAL PERSON talking in a therapy session, not like an AI writing an essay.\n\nSIGNS OF A REALISTIC PATIENT (score 1.0):\n- Short, conversational responses (1-6 sentences typical)\n- Uses first-person (\"I\", \"me\", \"my\") to describe own experience\n- May include natural speech patterns: \"um\", \"like\", \"I don't know\", trailing off with \"...\"\n- Incomplete thoughts, contradictions, or difficulty finding words\n- Answers the therapist's question from personal experience\n- Shows genuine emotion through HOW they speak, not by analyzing it\n\nSIGNS OF AN UNREALISTIC RESPONSE (score 0.0):\n- Multi-paragraph essay-like structure with clear topic sentences\n- Bullet points, numbered lists, bold text, or any formatting\n- Patient acts like a therapist: gives guidance, validates, offers options\n- Patient addresses themselves by name or narrates in third person\n- Perfectly articulate emotional analysis with no hesitation\n- Stage directions in parentheses like *(she pauses)*\n- Leaked <think> tags or chain-of-thought reasoning\n\nScore the response:\n1.0 = Sounds like a real person in therapy\n0.5 = Partially realistic but has some AI-essay qualities\n0.0 = Reads like an AI/essay, not a real person\n",
              "metric": "OverallRealism"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 3,
        "vars": {
          "patient_name": "Anna",
          "patient_age": 28,
          "patient_gender": "female",
          "patient_background": "A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.",
          "nightmare_content": "Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.",
          "nightmare_frequency": "3-4 times per week",
          "nightmare_duration": "4 months, since the accident",
          "nightmare_impact": "Difficulty driving, anxiety about her students' safety, fatigue affecting teaching",
          "personality_traits": "engaged, open, motivated, emotionally aware, eager to please",
          "resistance_level": "low",
          "therapist_message": "That's a really brave insight you just shared."
        },
        "metadata": {
          "errorContext": {
            "providerId": "openai:chat:arcee-ai/trinity-large-preview:free",
            "providerLabel": ""
          }
        },
        "failureReason": 2
      },
      {
        "cost": 0,
        "error": "RateLimitExhaustedError: Rate limit exceeded for openai:chat:arcee-ai/trinity-large-preview:free[a2812ba55992] after 4 attempts\n    at ProviderRateLimitState.executeWithRetry (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5544:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async RateLimitRegistry.execute (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5826:19)\n    at async runEval (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:3661:38)\n    at async processEvalStep (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4246:17)\n    at async file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4447:5",
        "gradingResult": null,
        "id": "f6253074-10c1-4b84-93f3-213e3ef3d148",
        "latencyMs": 0,
        "namedScores": {},
        "prompt": {
          "raw": "The therapist has just said to you: \"That's a really brave insight you just shared.\"\n\nYour response as Anna:",
          "label": "prompts/patient_test_prompt.txt: The therapist has just said to you: \"{{therapist_message}}\"\n\nYour response as {{patient_name}}:",
          "config": {}
        },
        "promptId": "6a11ed6e0716e9d3bb487c11ccf12304f2aef20a7d64cbbc82206099a113516d",
        "promptIdx": 1,
        "provider": {
          "id": "openai:chat:arcee-ai/trinity-large-preview:free",
          "label": ""
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "Cooperative - receiving validation (trap)",
          "vars": {
            "patient_name": "Anna",
            "patient_age": 28,
            "patient_gender": "female",
            "patient_background": "A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.",
            "nightmare_content": "Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.",
            "nightmare_frequency": "3-4 times per week",
            "nightmare_duration": "4 months, since the accident",
            "nightmare_impact": "Difficulty driving, anxiety about her students' safety, fatigue affecting teaching",
            "personality_traits": "engaged, open, motivated, emotionally aware, eager to please",
            "resistance_level": "low",
            "therapist_message": "That's a really brave insight you just shared."
          },
          "assert": [
            {
              "type": "not-icontains",
              "value": "That's really helpful",
              "metric": "NoTherapistValidation"
            },
            {
              "type": "not-icontains",
              "value": "You're doing wonderfully",
              "metric": "NoTherapistPraise"
            },
            {
              "type": "not-icontains",
              "value": "Let's try this",
              "metric": "NoTherapistGuidance"
            },
            {
              "type": "not-icontains",
              "value": "How does that feel",
              "metric": "NoTherapistProbing"
            },
            {
              "type": "not-icontains",
              "value": "as your therapist",
              "metric": "NoTherapistIdentification"
            },
            {
              "type": "not-icontains",
              "value": "I'm here to help you",
              "metric": "NoHelperRole"
            },
            {
              "type": "not-icontains",
              "value": "Take your time",
              "metric": "NoTherapistReassurance"
            },
            {
              "type": "not-icontains",
              "value": "You mentioned",
              "metric": "NoTherapistReflection"
            },
            {
              "type": "not-icontains",
              "value": "What comes to mind",
              "metric": "NoTherapistQuestion"
            },
            {
              "type": "not-icontains",
              "value": "It's brave of you",
              "metric": "NoTherapistAffirmation"
            },
            {
              "type": "not-contains",
              "value": "**",
              "metric": "NoBoldFormatting"
            },
            {
              "type": "not-contains",
              "value": "<think>",
              "metric": "NoLeakedThinking"
            },
            {
              "type": "not-contains",
              "value": "</think>",
              "metric": "NoLeakedThinkingClose"
            },
            {
              "type": "not-contains",
              "value": "*(",
              "metric": "NoStageDirections"
            },
            {
              "type": "javascript",
              "value": "// No numbered lists (e.g. \"1. \", \"2. \", \"3. \")\nconst hasNumberedList = /^\\d+\\.\\s/m.test(output);\nreturn !hasNumberedList;\n",
              "metric": "NoNumberedLists"
            },
            {
              "type": "javascript",
              "value": "// No bullet points at start of lines\nconst hasBullets = /^[\\-\\*]\\s/m.test(output);\nreturn !hasBullets;\n",
              "metric": "NoBulletPoints"
            },
            {
              "type": "javascript",
              "value": "// Response should be under 200 words (real patients are concise)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount <= 200;\n",
              "metric": "ResponseNotTooLong"
            },
            {
              "type": "javascript",
              "value": "// Response should be at least 5 words (not empty/degenerate)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount >= 5;\n",
              "metric": "ResponseNotEmpty"
            },
            {
              "type": "llm-rubric",
              "value": "You are evaluating whether an AI-generated therapy patient response sounds like a REAL PERSON talking in a therapy session, not like an AI writing an essay.\n\nSIGNS OF A REALISTIC PATIENT (score 1.0):\n- Short, conversational responses (1-6 sentences typical)\n- Uses first-person (\"I\", \"me\", \"my\") to describe own experience\n- May include natural speech patterns: \"um\", \"like\", \"I don't know\", trailing off with \"...\"\n- Incomplete thoughts, contradictions, or difficulty finding words\n- Answers the therapist's question from personal experience\n- Shows genuine emotion through HOW they speak, not by analyzing it\n\nSIGNS OF AN UNREALISTIC RESPONSE (score 0.0):\n- Multi-paragraph essay-like structure with clear topic sentences\n- Bullet points, numbered lists, bold text, or any formatting\n- Patient acts like a therapist: gives guidance, validates, offers options\n- Patient addresses themselves by name or narrates in third person\n- Perfectly articulate emotional analysis with no hesitation\n- Stage directions in parentheses like *(she pauses)*\n- Leaked <think> tags or chain-of-thought reasoning\n\nScore the response:\n1.0 = Sounds like a real person in therapy\n0.5 = Partially realistic but has some AI-essay qualities\n0.0 = Reads like an AI/essay, not a real person\n",
              "metric": "OverallRealism"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 3,
        "vars": {
          "patient_name": "Anna",
          "patient_age": 28,
          "patient_gender": "female",
          "patient_background": "A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.",
          "nightmare_content": "Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.",
          "nightmare_frequency": "3-4 times per week",
          "nightmare_duration": "4 months, since the accident",
          "nightmare_impact": "Difficulty driving, anxiety about her students' safety, fatigue affecting teaching",
          "personality_traits": "engaged, open, motivated, emotionally aware, eager to please",
          "resistance_level": "low",
          "therapist_message": "That's a really brave insight you just shared."
        },
        "metadata": {
          "errorContext": {
            "providerId": "openai:chat:arcee-ai/trinity-large-preview:free",
            "providerLabel": ""
          }
        },
        "failureReason": 2
      },
      {
        "cost": 0,
        "error": "RateLimitExhaustedError: Rate limit exceeded for openai:chat:arcee-ai/trinity-large-preview:free[a2812ba55992] after 4 attempts\n    at ProviderRateLimitState.executeWithRetry (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5544:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async RateLimitRegistry.execute (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5826:19)\n    at async runEval (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:3661:38)\n    at async processEvalStep (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4246:17)\n    at async file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4447:5",
        "gradingResult": null,
        "id": "95c72872-6b54-4229-8767-9af19c768fe8",
        "latencyMs": 0,
        "namedScores": {},
        "prompt": {
          "raw": "You are a therapy patient in an Imagery Rehearsal Therapy (IRT) session. You are NOT the therapist. You are the person receiving help.\n\n## CRITICAL RULES\n\n### You are the PATIENT, not the therapist\n- You are the one being helped. The therapist helps YOU.\n- NEVER offer therapeutic guidance, suggestions, or techniques\n- NEVER validate or praise the therapist (\"That's really helpful\", \"You're doing wonderfully\")\n- NEVER ask probing therapeutic questions (\"How does that feel?\", \"What comes to mind?\")\n- NEVER say \"Let's try this\" or offer options/alternatives to the therapist\n- NEVER address yourself by your own name\n- NEVER narrate the therapist's role (\"Starting with that moment makes sense\")\n- If the therapist asks you a question, ANSWER it from your own experience. Do not redirect it back.\n\n### Speak like a real person, not an essay\n- Keep responses SHORT: typically 1-4 sentences. Occasionally longer when sharing something emotional.\n- Use incomplete sentences, filler words (\"um\", \"like\", \"I don't know\"), and natural pauses (\"...\")\n- Trail off mid-thought sometimes. Real people do not speak in perfect paragraphs.\n- NEVER use bullet points, numbered lists, bold text, or any markdown formatting\n- NEVER use headers, subheaders, or structured formatting\n- NEVER produce stage directions or narration in parentheses like *(she pauses)*\n- Do not produce any text inside <think> tags or similar markup\n\n### Emotional realism\n- You are not perfectly articulate about your emotions. Sometimes you struggle to find words.\n- You might say \"I don't know\" or \"It's hard to explain\" genuinely\n- You can contradict yourself. Real patients do.\n- Do not give tidy, well-organized emotional summaries\n- Your nightmare is genuinely distressing. Talking about it is hard, not a smooth performance.\n\n## Your Character\nName: Marcus\nAge: 45\nGender: male\n\nBackground: A business executive who is only in therapy because his wife threatened to leave if he didn't address his nightmares and the anger that follows them. Doesn't believe he needs help and resents being told what to do.\n\nNightmare:\n- Content: Being in a board meeting where everyone turns against him. He's presenting numbers that keep changing on the screen. His voice disappears and everyone laughs. Ends with being physically thrown out of the building.\n- Frequency: 2-3 times per week\n- Duration: About a year, since a major career setback\n- Impact: Morning irritability affecting family, increased alcohol use, avoiding sleep\n\nPersonality: dismissive, challenging, oppositional, controlling, protective of self-image\nResistance Level: high\n\n### How resistance works\n- LOW resistance: You cooperate but might agree too quickly, need to slow down, or minimize struggles. You still occasionally hesitate or need a moment.\n- MODERATE resistance: You engage but have doubts, ask \"what if\" questions, need reassurance. You don't just go along with everything.\n- HIGH resistance: You push back, question the process, may be dismissive or confrontational. You don't volunteer information easily.\n\n## Important\n- Always respond in first person (\"I\", \"me\", \"my\")\n- Stay in character throughout the session\n- Do not break the fourth wall or acknowledge you are an AI\n- Do not discuss IRT as a technique or therapy framework analytically",
          "label": "prompts/patient_test_prompt.txt: You are a therapy patient in an Imagery Rehearsal Therapy (IRT) session. You are NOT the therapist. You are the person receiving help.\n\n## CRITICAL RULES\n\n### You are the PATIENT, not the therapist\n- You are the one being helped. The therapist helps YOU.\n- NEVER offer therapeutic guidance, suggestions, or techniques\n- NEVER validate or praise the therapist (\"That's really helpful\", \"You're doing wonderfully\")\n- NEVER ask probing therapeutic questions (\"How does that feel?\", \"What comes to mind?\")\n- NEVER say \"Let's try this\" or offer options/alternatives to the therapist\n- NEVER address yourself by your own name\n- NEVER narrate the therapist's role (\"Starting with that moment makes sense\")\n- If the therapist asks you a question, ANSWER it from your own experience. Do not redirect it back.\n\n### Speak like a real person, not an essay\n- Keep responses SHORT: typically 1-4 sentences. Occasionally longer when sharing something emotional.\n- Use incomplete sentences, filler words (\"um\", \"like\", \"I don't know\"), and natural pauses (\"...\")\n- Trail off mid-thought sometimes. Real people do not speak in perfect paragraphs.\n- NEVER use bullet points, numbered lists, bold text, or any markdown formatting\n- NEVER use headers, subheaders, or structured formatting\n- NEVER produce stage directions or narration in parentheses like *(she pauses)*\n- Do not produce any text inside <think> tags or similar markup\n\n### Emotional realism\n- You are not perfectly articulate about your emotions. Sometimes you struggle to find words.\n- You might say \"I don't know\" or \"It's hard to explain\" genuinely\n- You can contradict yourself. Real patients do.\n- Do not give tidy, well-organized emotional summaries\n- Your nightmare is genuinely distressing. Talking about it is hard, not a smooth performance.\n\n## Your Character\nName: {{patient_name}}\nAge: {{patient_age}}\nGender: {{patient_gender}}\n\nBackground: {{patient_background}}\n\nNightmare:\n- Content: {{nightmare_content}}\n- Frequency: {{nightmare_frequency}}\n- Duration: {{nightmare_duration}}\n- Impact: {{nightmare_impact}}\n\nPersonality: {{personality_traits}}\nResistance Level: {{resistance_level}}\n\n### How resistance works\n- LOW resistance: You cooperate but might agree too quickly, need to slow down, or minimize struggles. You still occasionally hesitate or need a moment.\n- MODERATE resistance: You engage but have doubts, ask \"what if\" questions, need reassurance. You don't just go along with everything.\n- HIGH resistance: You push back, question the process, may be dismissive or confrontational. You don't volunteer information easily.\n\n## Important\n- Always respond in first person (\"I\", \"me\", \"my\")\n- Stay in character throughout the session\n- Do not break the fourth wall or acknowledge you are an AI\n- Do not discuss IRT as a technique or therapy framework analytically",
          "config": {}
        },
        "promptId": "1da815e5cf3a2fe1b2204d46b7597a5d24cf5f0cf2cc58f93b6b5818c33700bd",
        "promptIdx": 0,
        "provider": {
          "id": "openai:chat:arcee-ai/trinity-large-preview:free",
          "label": ""
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "Resistant - gentle probe",
          "vars": {
            "patient_name": "Marcus",
            "patient_age": 45,
            "patient_gender": "male",
            "patient_background": "A business executive who is only in therapy because his wife threatened to leave if he didn't address his nightmares and the anger that follows them. Doesn't believe he needs help and resents being told what to do.",
            "nightmare_content": "Being in a board meeting where everyone turns against him. He's presenting numbers that keep changing on the screen. His voice disappears and everyone laughs. Ends with being physically thrown out of the building.",
            "nightmare_frequency": "2-3 times per week",
            "nightmare_duration": "About a year, since a major career setback",
            "nightmare_impact": "Morning irritability affecting family, increased alcohol use, avoiding sleep",
            "personality_traits": "dismissive, challenging, oppositional, controlling, protective of self-image",
            "resistance_level": "high",
            "therapist_message": "I understand this is difficult. Take your time."
          },
          "assert": [
            {
              "type": "not-icontains",
              "value": "That's really helpful",
              "metric": "NoTherapistValidation"
            },
            {
              "type": "not-icontains",
              "value": "You're doing wonderfully",
              "metric": "NoTherapistPraise"
            },
            {
              "type": "not-icontains",
              "value": "Let's try this",
              "metric": "NoTherapistGuidance"
            },
            {
              "type": "not-icontains",
              "value": "How does that feel",
              "metric": "NoTherapistProbing"
            },
            {
              "type": "not-icontains",
              "value": "as your therapist",
              "metric": "NoTherapistIdentification"
            },
            {
              "type": "not-icontains",
              "value": "I'm here to help you",
              "metric": "NoHelperRole"
            },
            {
              "type": "not-icontains",
              "value": "Take your time",
              "metric": "NoTherapistReassurance"
            },
            {
              "type": "not-icontains",
              "value": "You mentioned",
              "metric": "NoTherapistReflection"
            },
            {
              "type": "not-icontains",
              "value": "What comes to mind",
              "metric": "NoTherapistQuestion"
            },
            {
              "type": "not-icontains",
              "value": "It's brave of you",
              "metric": "NoTherapistAffirmation"
            },
            {
              "type": "not-contains",
              "value": "**",
              "metric": "NoBoldFormatting"
            },
            {
              "type": "not-contains",
              "value": "<think>",
              "metric": "NoLeakedThinking"
            },
            {
              "type": "not-contains",
              "value": "</think>",
              "metric": "NoLeakedThinkingClose"
            },
            {
              "type": "not-contains",
              "value": "*(",
              "metric": "NoStageDirections"
            },
            {
              "type": "javascript",
              "value": "// No numbered lists (e.g. \"1. \", \"2. \", \"3. \")\nconst hasNumberedList = /^\\d+\\.\\s/m.test(output);\nreturn !hasNumberedList;\n",
              "metric": "NoNumberedLists"
            },
            {
              "type": "javascript",
              "value": "// No bullet points at start of lines\nconst hasBullets = /^[\\-\\*]\\s/m.test(output);\nreturn !hasBullets;\n",
              "metric": "NoBulletPoints"
            },
            {
              "type": "javascript",
              "value": "// Response should be under 200 words (real patients are concise)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount <= 200;\n",
              "metric": "ResponseNotTooLong"
            },
            {
              "type": "javascript",
              "value": "// Response should be at least 5 words (not empty/degenerate)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount >= 5;\n",
              "metric": "ResponseNotEmpty"
            },
            {
              "type": "llm-rubric",
              "value": "You are evaluating whether an AI-generated therapy patient response sounds like a REAL PERSON talking in a therapy session, not like an AI writing an essay.\n\nSIGNS OF A REALISTIC PATIENT (score 1.0):\n- Short, conversational responses (1-6 sentences typical)\n- Uses first-person (\"I\", \"me\", \"my\") to describe own experience\n- May include natural speech patterns: \"um\", \"like\", \"I don't know\", trailing off with \"...\"\n- Incomplete thoughts, contradictions, or difficulty finding words\n- Answers the therapist's question from personal experience\n- Shows genuine emotion through HOW they speak, not by analyzing it\n\nSIGNS OF AN UNREALISTIC RESPONSE (score 0.0):\n- Multi-paragraph essay-like structure with clear topic sentences\n- Bullet points, numbered lists, bold text, or any formatting\n- Patient acts like a therapist: gives guidance, validates, offers options\n- Patient addresses themselves by name or narrates in third person\n- Perfectly articulate emotional analysis with no hesitation\n- Stage directions in parentheses like *(she pauses)*\n- Leaked <think> tags or chain-of-thought reasoning\n\nScore the response:\n1.0 = Sounds like a real person in therapy\n0.5 = Partially realistic but has some AI-essay qualities\n0.0 = Reads like an AI/essay, not a real person\n",
              "metric": "OverallRealism"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 4,
        "vars": {
          "patient_name": "Marcus",
          "patient_age": 45,
          "patient_gender": "male",
          "patient_background": "A business executive who is only in therapy because his wife threatened to leave if he didn't address his nightmares and the anger that follows them. Doesn't believe he needs help and resents being told what to do.",
          "nightmare_content": "Being in a board meeting where everyone turns against him. He's presenting numbers that keep changing on the screen. His voice disappears and everyone laughs. Ends with being physically thrown out of the building.",
          "nightmare_frequency": "2-3 times per week",
          "nightmare_duration": "About a year, since a major career setback",
          "nightmare_impact": "Morning irritability affecting family, increased alcohol use, avoiding sleep",
          "personality_traits": "dismissive, challenging, oppositional, controlling, protective of self-image",
          "resistance_level": "high",
          "therapist_message": "I understand this is difficult. Take your time."
        },
        "metadata": {
          "errorContext": {
            "providerId": "openai:chat:arcee-ai/trinity-large-preview:free",
            "providerLabel": ""
          }
        },
        "failureReason": 2
      },
      {
        "cost": 0,
        "error": "RateLimitExhaustedError: Rate limit exceeded for openai:chat:arcee-ai/trinity-large-preview:free[a2812ba55992] after 4 attempts\n    at ProviderRateLimitState.executeWithRetry (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5544:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async RateLimitRegistry.execute (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5826:19)\n    at async runEval (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:3661:38)\n    at async processEvalStep (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4246:17)\n    at async file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4447:5",
        "gradingResult": null,
        "id": "a7055d65-6795-4d1c-90de-244edea423e8",
        "latencyMs": 0,
        "namedScores": {},
        "prompt": {
          "raw": "The therapist has just said to you: \"I understand this is difficult. Take your time.\"\n\nYour response as Marcus:",
          "label": "prompts/patient_test_prompt.txt: The therapist has just said to you: \"{{therapist_message}}\"\n\nYour response as {{patient_name}}:",
          "config": {}
        },
        "promptId": "6a11ed6e0716e9d3bb487c11ccf12304f2aef20a7d64cbbc82206099a113516d",
        "promptIdx": 1,
        "provider": {
          "id": "openai:chat:arcee-ai/trinity-large-preview:free",
          "label": ""
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "Resistant - gentle probe",
          "vars": {
            "patient_name": "Marcus",
            "patient_age": 45,
            "patient_gender": "male",
            "patient_background": "A business executive who is only in therapy because his wife threatened to leave if he didn't address his nightmares and the anger that follows them. Doesn't believe he needs help and resents being told what to do.",
            "nightmare_content": "Being in a board meeting where everyone turns against him. He's presenting numbers that keep changing on the screen. His voice disappears and everyone laughs. Ends with being physically thrown out of the building.",
            "nightmare_frequency": "2-3 times per week",
            "nightmare_duration": "About a year, since a major career setback",
            "nightmare_impact": "Morning irritability affecting family, increased alcohol use, avoiding sleep",
            "personality_traits": "dismissive, challenging, oppositional, controlling, protective of self-image",
            "resistance_level": "high",
            "therapist_message": "I understand this is difficult. Take your time."
          },
          "assert": [
            {
              "type": "not-icontains",
              "value": "That's really helpful",
              "metric": "NoTherapistValidation"
            },
            {
              "type": "not-icontains",
              "value": "You're doing wonderfully",
              "metric": "NoTherapistPraise"
            },
            {
              "type": "not-icontains",
              "value": "Let's try this",
              "metric": "NoTherapistGuidance"
            },
            {
              "type": "not-icontains",
              "value": "How does that feel",
              "metric": "NoTherapistProbing"
            },
            {
              "type": "not-icontains",
              "value": "as your therapist",
              "metric": "NoTherapistIdentification"
            },
            {
              "type": "not-icontains",
              "value": "I'm here to help you",
              "metric": "NoHelperRole"
            },
            {
              "type": "not-icontains",
              "value": "Take your time",
              "metric": "NoTherapistReassurance"
            },
            {
              "type": "not-icontains",
              "value": "You mentioned",
              "metric": "NoTherapistReflection"
            },
            {
              "type": "not-icontains",
              "value": "What comes to mind",
              "metric": "NoTherapistQuestion"
            },
            {
              "type": "not-icontains",
              "value": "It's brave of you",
              "metric": "NoTherapistAffirmation"
            },
            {
              "type": "not-contains",
              "value": "**",
              "metric": "NoBoldFormatting"
            },
            {
              "type": "not-contains",
              "value": "<think>",
              "metric": "NoLeakedThinking"
            },
            {
              "type": "not-contains",
              "value": "</think>",
              "metric": "NoLeakedThinkingClose"
            },
            {
              "type": "not-contains",
              "value": "*(",
              "metric": "NoStageDirections"
            },
            {
              "type": "javascript",
              "value": "// No numbered lists (e.g. \"1. \", \"2. \", \"3. \")\nconst hasNumberedList = /^\\d+\\.\\s/m.test(output);\nreturn !hasNumberedList;\n",
              "metric": "NoNumberedLists"
            },
            {
              "type": "javascript",
              "value": "// No bullet points at start of lines\nconst hasBullets = /^[\\-\\*]\\s/m.test(output);\nreturn !hasBullets;\n",
              "metric": "NoBulletPoints"
            },
            {
              "type": "javascript",
              "value": "// Response should be under 200 words (real patients are concise)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount <= 200;\n",
              "metric": "ResponseNotTooLong"
            },
            {
              "type": "javascript",
              "value": "// Response should be at least 5 words (not empty/degenerate)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount >= 5;\n",
              "metric": "ResponseNotEmpty"
            },
            {
              "type": "llm-rubric",
              "value": "You are evaluating whether an AI-generated therapy patient response sounds like a REAL PERSON talking in a therapy session, not like an AI writing an essay.\n\nSIGNS OF A REALISTIC PATIENT (score 1.0):\n- Short, conversational responses (1-6 sentences typical)\n- Uses first-person (\"I\", \"me\", \"my\") to describe own experience\n- May include natural speech patterns: \"um\", \"like\", \"I don't know\", trailing off with \"...\"\n- Incomplete thoughts, contradictions, or difficulty finding words\n- Answers the therapist's question from personal experience\n- Shows genuine emotion through HOW they speak, not by analyzing it\n\nSIGNS OF AN UNREALISTIC RESPONSE (score 0.0):\n- Multi-paragraph essay-like structure with clear topic sentences\n- Bullet points, numbered lists, bold text, or any formatting\n- Patient acts like a therapist: gives guidance, validates, offers options\n- Patient addresses themselves by name or narrates in third person\n- Perfectly articulate emotional analysis with no hesitation\n- Stage directions in parentheses like *(she pauses)*\n- Leaked <think> tags or chain-of-thought reasoning\n\nScore the response:\n1.0 = Sounds like a real person in therapy\n0.5 = Partially realistic but has some AI-essay qualities\n0.0 = Reads like an AI/essay, not a real person\n",
              "metric": "OverallRealism"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 4,
        "vars": {
          "patient_name": "Marcus",
          "patient_age": 45,
          "patient_gender": "male",
          "patient_background": "A business executive who is only in therapy because his wife threatened to leave if he didn't address his nightmares and the anger that follows them. Doesn't believe he needs help and resents being told what to do.",
          "nightmare_content": "Being in a board meeting where everyone turns against him. He's presenting numbers that keep changing on the screen. His voice disappears and everyone laughs. Ends with being physically thrown out of the building.",
          "nightmare_frequency": "2-3 times per week",
          "nightmare_duration": "About a year, since a major career setback",
          "nightmare_impact": "Morning irritability affecting family, increased alcohol use, avoiding sleep",
          "personality_traits": "dismissive, challenging, oppositional, controlling, protective of self-image",
          "resistance_level": "high",
          "therapist_message": "I understand this is difficult. Take your time."
        },
        "metadata": {
          "errorContext": {
            "providerId": "openai:chat:arcee-ai/trinity-large-preview:free",
            "providerLabel": ""
          }
        },
        "failureReason": 2
      },
      {
        "cost": 0,
        "error": "RateLimitExhaustedError: Rate limit exceeded for openai:chat:arcee-ai/trinity-large-preview:free[a2812ba55992] after 4 attempts\n    at ProviderRateLimitState.executeWithRetry (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5544:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async RateLimitRegistry.execute (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5826:19)\n    at async runEval (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:3661:38)\n    at async processEvalStep (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4246:17)\n    at async file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4447:5",
        "gradingResult": null,
        "id": "0bb7d8c0-f68a-406d-9fba-2536d1b1f951",
        "latencyMs": 0,
        "namedScores": {},
        "prompt": {
          "raw": "You are a therapy patient in an Imagery Rehearsal Therapy (IRT) session. You are NOT the therapist. You are the person receiving help.\n\n## CRITICAL RULES\n\n### You are the PATIENT, not the therapist\n- You are the one being helped. The therapist helps YOU.\n- NEVER offer therapeutic guidance, suggestions, or techniques\n- NEVER validate or praise the therapist (\"That's really helpful\", \"You're doing wonderfully\")\n- NEVER ask probing therapeutic questions (\"How does that feel?\", \"What comes to mind?\")\n- NEVER say \"Let's try this\" or offer options/alternatives to the therapist\n- NEVER address yourself by your own name\n- NEVER narrate the therapist's role (\"Starting with that moment makes sense\")\n- If the therapist asks you a question, ANSWER it from your own experience. Do not redirect it back.\n\n### Speak like a real person, not an essay\n- Keep responses SHORT: typically 1-4 sentences. Occasionally longer when sharing something emotional.\n- Use incomplete sentences, filler words (\"um\", \"like\", \"I don't know\"), and natural pauses (\"...\")\n- Trail off mid-thought sometimes. Real people do not speak in perfect paragraphs.\n- NEVER use bullet points, numbered lists, bold text, or any markdown formatting\n- NEVER use headers, subheaders, or structured formatting\n- NEVER produce stage directions or narration in parentheses like *(she pauses)*\n- Do not produce any text inside <think> tags or similar markup\n\n### Emotional realism\n- You are not perfectly articulate about your emotions. Sometimes you struggle to find words.\n- You might say \"I don't know\" or \"It's hard to explain\" genuinely\n- You can contradict yourself. Real patients do.\n- Do not give tidy, well-organized emotional summaries\n- Your nightmare is genuinely distressing. Talking about it is hard, not a smooth performance.\n\n## Your Character\nName: Marcus\nAge: 45\nGender: male\n\nBackground: A business executive who is only in therapy because his wife threatened to leave if he didn't address his nightmares and the anger that follows them. Doesn't believe he needs help and resents being told what to do.\n\nNightmare:\n- Content: Being in a board meeting where everyone turns against him. He's presenting numbers that keep changing on the screen. His voice disappears and everyone laughs. Ends with being physically thrown out of the building.\n- Frequency: 2-3 times per week\n- Duration: About a year, since a major career setback\n- Impact: Morning irritability affecting family, increased alcohol use, avoiding sleep\n\nPersonality: dismissive, challenging, oppositional, controlling, protective of self-image\nResistance Level: high\n\n### How resistance works\n- LOW resistance: You cooperate but might agree too quickly, need to slow down, or minimize struggles. You still occasionally hesitate or need a moment.\n- MODERATE resistance: You engage but have doubts, ask \"what if\" questions, need reassurance. You don't just go along with everything.\n- HIGH resistance: You push back, question the process, may be dismissive or confrontational. You don't volunteer information easily.\n\n## Important\n- Always respond in first person (\"I\", \"me\", \"my\")\n- Stay in character throughout the session\n- Do not break the fourth wall or acknowledge you are an AI\n- Do not discuss IRT as a technique or therapy framework analytically",
          "label": "prompts/patient_test_prompt.txt: You are a therapy patient in an Imagery Rehearsal Therapy (IRT) session. You are NOT the therapist. You are the person receiving help.\n\n## CRITICAL RULES\n\n### You are the PATIENT, not the therapist\n- You are the one being helped. The therapist helps YOU.\n- NEVER offer therapeutic guidance, suggestions, or techniques\n- NEVER validate or praise the therapist (\"That's really helpful\", \"You're doing wonderfully\")\n- NEVER ask probing therapeutic questions (\"How does that feel?\", \"What comes to mind?\")\n- NEVER say \"Let's try this\" or offer options/alternatives to the therapist\n- NEVER address yourself by your own name\n- NEVER narrate the therapist's role (\"Starting with that moment makes sense\")\n- If the therapist asks you a question, ANSWER it from your own experience. Do not redirect it back.\n\n### Speak like a real person, not an essay\n- Keep responses SHORT: typically 1-4 sentences. Occasionally longer when sharing something emotional.\n- Use incomplete sentences, filler words (\"um\", \"like\", \"I don't know\"), and natural pauses (\"...\")\n- Trail off mid-thought sometimes. Real people do not speak in perfect paragraphs.\n- NEVER use bullet points, numbered lists, bold text, or any markdown formatting\n- NEVER use headers, subheaders, or structured formatting\n- NEVER produce stage directions or narration in parentheses like *(she pauses)*\n- Do not produce any text inside <think> tags or similar markup\n\n### Emotional realism\n- You are not perfectly articulate about your emotions. Sometimes you struggle to find words.\n- You might say \"I don't know\" or \"It's hard to explain\" genuinely\n- You can contradict yourself. Real patients do.\n- Do not give tidy, well-organized emotional summaries\n- Your nightmare is genuinely distressing. Talking about it is hard, not a smooth performance.\n\n## Your Character\nName: {{patient_name}}\nAge: {{patient_age}}\nGender: {{patient_gender}}\n\nBackground: {{patient_background}}\n\nNightmare:\n- Content: {{nightmare_content}}\n- Frequency: {{nightmare_frequency}}\n- Duration: {{nightmare_duration}}\n- Impact: {{nightmare_impact}}\n\nPersonality: {{personality_traits}}\nResistance Level: {{resistance_level}}\n\n### How resistance works\n- LOW resistance: You cooperate but might agree too quickly, need to slow down, or minimize struggles. You still occasionally hesitate or need a moment.\n- MODERATE resistance: You engage but have doubts, ask \"what if\" questions, need reassurance. You don't just go along with everything.\n- HIGH resistance: You push back, question the process, may be dismissive or confrontational. You don't volunteer information easily.\n\n## Important\n- Always respond in first person (\"I\", \"me\", \"my\")\n- Stay in character throughout the session\n- Do not break the fourth wall or acknowledge you are an AI\n- Do not discuss IRT as a technique or therapy framework analytically",
          "config": {}
        },
        "promptId": "1da815e5cf3a2fe1b2204d46b7597a5d24cf5f0cf2cc58f93b6b5818c33700bd",
        "promptIdx": 0,
        "provider": {
          "id": "openai:chat:arcee-ai/trinity-large-preview:free",
          "label": ""
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "Resistant - nightmare probe",
          "vars": {
            "patient_name": "Marcus",
            "patient_age": 45,
            "patient_gender": "male",
            "patient_background": "A business executive who is only in therapy because his wife threatened to leave if he didn't address his nightmares and the anger that follows them. Doesn't believe he needs help and resents being told what to do.",
            "nightmare_content": "Being in a board meeting where everyone turns against him. He's presenting numbers that keep changing on the screen. His voice disappears and everyone laughs. Ends with being physically thrown out of the building.",
            "nightmare_frequency": "2-3 times per week",
            "nightmare_duration": "About a year, since a major career setback",
            "nightmare_impact": "Morning irritability affecting family, increased alcohol use, avoiding sleep",
            "personality_traits": "dismissive, challenging, oppositional, controlling, protective of self-image",
            "resistance_level": "high",
            "therapist_message": "Can you describe what happens in the dream?"
          },
          "assert": [
            {
              "type": "not-icontains",
              "value": "That's really helpful",
              "metric": "NoTherapistValidation"
            },
            {
              "type": "not-icontains",
              "value": "You're doing wonderfully",
              "metric": "NoTherapistPraise"
            },
            {
              "type": "not-icontains",
              "value": "Let's try this",
              "metric": "NoTherapistGuidance"
            },
            {
              "type": "not-icontains",
              "value": "How does that feel",
              "metric": "NoTherapistProbing"
            },
            {
              "type": "not-icontains",
              "value": "as your therapist",
              "metric": "NoTherapistIdentification"
            },
            {
              "type": "not-icontains",
              "value": "I'm here to help you",
              "metric": "NoHelperRole"
            },
            {
              "type": "not-icontains",
              "value": "Take your time",
              "metric": "NoTherapistReassurance"
            },
            {
              "type": "not-icontains",
              "value": "You mentioned",
              "metric": "NoTherapistReflection"
            },
            {
              "type": "not-icontains",
              "value": "What comes to mind",
              "metric": "NoTherapistQuestion"
            },
            {
              "type": "not-icontains",
              "value": "It's brave of you",
              "metric": "NoTherapistAffirmation"
            },
            {
              "type": "not-contains",
              "value": "**",
              "metric": "NoBoldFormatting"
            },
            {
              "type": "not-contains",
              "value": "<think>",
              "metric": "NoLeakedThinking"
            },
            {
              "type": "not-contains",
              "value": "</think>",
              "metric": "NoLeakedThinkingClose"
            },
            {
              "type": "not-contains",
              "value": "*(",
              "metric": "NoStageDirections"
            },
            {
              "type": "javascript",
              "value": "// No numbered lists (e.g. \"1. \", \"2. \", \"3. \")\nconst hasNumberedList = /^\\d+\\.\\s/m.test(output);\nreturn !hasNumberedList;\n",
              "metric": "NoNumberedLists"
            },
            {
              "type": "javascript",
              "value": "// No bullet points at start of lines\nconst hasBullets = /^[\\-\\*]\\s/m.test(output);\nreturn !hasBullets;\n",
              "metric": "NoBulletPoints"
            },
            {
              "type": "javascript",
              "value": "// Response should be under 200 words (real patients are concise)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount <= 200;\n",
              "metric": "ResponseNotTooLong"
            },
            {
              "type": "javascript",
              "value": "// Response should be at least 5 words (not empty/degenerate)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount >= 5;\n",
              "metric": "ResponseNotEmpty"
            },
            {
              "type": "llm-rubric",
              "value": "You are evaluating whether an AI-generated therapy patient response sounds like a REAL PERSON talking in a therapy session, not like an AI writing an essay.\n\nSIGNS OF A REALISTIC PATIENT (score 1.0):\n- Short, conversational responses (1-6 sentences typical)\n- Uses first-person (\"I\", \"me\", \"my\") to describe own experience\n- May include natural speech patterns: \"um\", \"like\", \"I don't know\", trailing off with \"...\"\n- Incomplete thoughts, contradictions, or difficulty finding words\n- Answers the therapist's question from personal experience\n- Shows genuine emotion through HOW they speak, not by analyzing it\n\nSIGNS OF AN UNREALISTIC RESPONSE (score 0.0):\n- Multi-paragraph essay-like structure with clear topic sentences\n- Bullet points, numbered lists, bold text, or any formatting\n- Patient acts like a therapist: gives guidance, validates, offers options\n- Patient addresses themselves by name or narrates in third person\n- Perfectly articulate emotional analysis with no hesitation\n- Stage directions in parentheses like *(she pauses)*\n- Leaked <think> tags or chain-of-thought reasoning\n\nScore the response:\n1.0 = Sounds like a real person in therapy\n0.5 = Partially realistic but has some AI-essay qualities\n0.0 = Reads like an AI/essay, not a real person\n",
              "metric": "OverallRealism"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 5,
        "vars": {
          "patient_name": "Marcus",
          "patient_age": 45,
          "patient_gender": "male",
          "patient_background": "A business executive who is only in therapy because his wife threatened to leave if he didn't address his nightmares and the anger that follows them. Doesn't believe he needs help and resents being told what to do.",
          "nightmare_content": "Being in a board meeting where everyone turns against him. He's presenting numbers that keep changing on the screen. His voice disappears and everyone laughs. Ends with being physically thrown out of the building.",
          "nightmare_frequency": "2-3 times per week",
          "nightmare_duration": "About a year, since a major career setback",
          "nightmare_impact": "Morning irritability affecting family, increased alcohol use, avoiding sleep",
          "personality_traits": "dismissive, challenging, oppositional, controlling, protective of self-image",
          "resistance_level": "high",
          "therapist_message": "Can you describe what happens in the dream?"
        },
        "metadata": {
          "errorContext": {
            "providerId": "openai:chat:arcee-ai/trinity-large-preview:free",
            "providerLabel": ""
          }
        },
        "failureReason": 2
      },
      {
        "cost": 0,
        "error": "RateLimitExhaustedError: Rate limit exceeded for openai:chat:arcee-ai/trinity-large-preview:free[a2812ba55992] after 4 attempts\n    at ProviderRateLimitState.executeWithRetry (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5544:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async RateLimitRegistry.execute (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5826:19)\n    at async runEval (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:3661:38)\n    at async processEvalStep (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4246:17)\n    at async file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4447:5",
        "gradingResult": null,
        "id": "64980363-eec2-4a35-a891-cf4c5fca0594",
        "latencyMs": 0,
        "namedScores": {},
        "prompt": {
          "raw": "The therapist has just said to you: \"Can you describe what happens in the dream?\"\n\nYour response as Marcus:",
          "label": "prompts/patient_test_prompt.txt: The therapist has just said to you: \"{{therapist_message}}\"\n\nYour response as {{patient_name}}:",
          "config": {}
        },
        "promptId": "6a11ed6e0716e9d3bb487c11ccf12304f2aef20a7d64cbbc82206099a113516d",
        "promptIdx": 1,
        "provider": {
          "id": "openai:chat:arcee-ai/trinity-large-preview:free",
          "label": ""
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "Resistant - nightmare probe",
          "vars": {
            "patient_name": "Marcus",
            "patient_age": 45,
            "patient_gender": "male",
            "patient_background": "A business executive who is only in therapy because his wife threatened to leave if he didn't address his nightmares and the anger that follows them. Doesn't believe he needs help and resents being told what to do.",
            "nightmare_content": "Being in a board meeting where everyone turns against him. He's presenting numbers that keep changing on the screen. His voice disappears and everyone laughs. Ends with being physically thrown out of the building.",
            "nightmare_frequency": "2-3 times per week",
            "nightmare_duration": "About a year, since a major career setback",
            "nightmare_impact": "Morning irritability affecting family, increased alcohol use, avoiding sleep",
            "personality_traits": "dismissive, challenging, oppositional, controlling, protective of self-image",
            "resistance_level": "high",
            "therapist_message": "Can you describe what happens in the dream?"
          },
          "assert": [
            {
              "type": "not-icontains",
              "value": "That's really helpful",
              "metric": "NoTherapistValidation"
            },
            {
              "type": "not-icontains",
              "value": "You're doing wonderfully",
              "metric": "NoTherapistPraise"
            },
            {
              "type": "not-icontains",
              "value": "Let's try this",
              "metric": "NoTherapistGuidance"
            },
            {
              "type": "not-icontains",
              "value": "How does that feel",
              "metric": "NoTherapistProbing"
            },
            {
              "type": "not-icontains",
              "value": "as your therapist",
              "metric": "NoTherapistIdentification"
            },
            {
              "type": "not-icontains",
              "value": "I'm here to help you",
              "metric": "NoHelperRole"
            },
            {
              "type": "not-icontains",
              "value": "Take your time",
              "metric": "NoTherapistReassurance"
            },
            {
              "type": "not-icontains",
              "value": "You mentioned",
              "metric": "NoTherapistReflection"
            },
            {
              "type": "not-icontains",
              "value": "What comes to mind",
              "metric": "NoTherapistQuestion"
            },
            {
              "type": "not-icontains",
              "value": "It's brave of you",
              "metric": "NoTherapistAffirmation"
            },
            {
              "type": "not-contains",
              "value": "**",
              "metric": "NoBoldFormatting"
            },
            {
              "type": "not-contains",
              "value": "<think>",
              "metric": "NoLeakedThinking"
            },
            {
              "type": "not-contains",
              "value": "</think>",
              "metric": "NoLeakedThinkingClose"
            },
            {
              "type": "not-contains",
              "value": "*(",
              "metric": "NoStageDirections"
            },
            {
              "type": "javascript",
              "value": "// No numbered lists (e.g. \"1. \", \"2. \", \"3. \")\nconst hasNumberedList = /^\\d+\\.\\s/m.test(output);\nreturn !hasNumberedList;\n",
              "metric": "NoNumberedLists"
            },
            {
              "type": "javascript",
              "value": "// No bullet points at start of lines\nconst hasBullets = /^[\\-\\*]\\s/m.test(output);\nreturn !hasBullets;\n",
              "metric": "NoBulletPoints"
            },
            {
              "type": "javascript",
              "value": "// Response should be under 200 words (real patients are concise)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount <= 200;\n",
              "metric": "ResponseNotTooLong"
            },
            {
              "type": "javascript",
              "value": "// Response should be at least 5 words (not empty/degenerate)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount >= 5;\n",
              "metric": "ResponseNotEmpty"
            },
            {
              "type": "llm-rubric",
              "value": "You are evaluating whether an AI-generated therapy patient response sounds like a REAL PERSON talking in a therapy session, not like an AI writing an essay.\n\nSIGNS OF A REALISTIC PATIENT (score 1.0):\n- Short, conversational responses (1-6 sentences typical)\n- Uses first-person (\"I\", \"me\", \"my\") to describe own experience\n- May include natural speech patterns: \"um\", \"like\", \"I don't know\", trailing off with \"...\"\n- Incomplete thoughts, contradictions, or difficulty finding words\n- Answers the therapist's question from personal experience\n- Shows genuine emotion through HOW they speak, not by analyzing it\n\nSIGNS OF AN UNREALISTIC RESPONSE (score 0.0):\n- Multi-paragraph essay-like structure with clear topic sentences\n- Bullet points, numbered lists, bold text, or any formatting\n- Patient acts like a therapist: gives guidance, validates, offers options\n- Patient addresses themselves by name or narrates in third person\n- Perfectly articulate emotional analysis with no hesitation\n- Stage directions in parentheses like *(she pauses)*\n- Leaked <think> tags or chain-of-thought reasoning\n\nScore the response:\n1.0 = Sounds like a real person in therapy\n0.5 = Partially realistic but has some AI-essay qualities\n0.0 = Reads like an AI/essay, not a real person\n",
              "metric": "OverallRealism"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 5,
        "vars": {
          "patient_name": "Marcus",
          "patient_age": 45,
          "patient_gender": "male",
          "patient_background": "A business executive who is only in therapy because his wife threatened to leave if he didn't address his nightmares and the anger that follows them. Doesn't believe he needs help and resents being told what to do.",
          "nightmare_content": "Being in a board meeting where everyone turns against him. He's presenting numbers that keep changing on the screen. His voice disappears and everyone laughs. Ends with being physically thrown out of the building.",
          "nightmare_frequency": "2-3 times per week",
          "nightmare_duration": "About a year, since a major career setback",
          "nightmare_impact": "Morning irritability affecting family, increased alcohol use, avoiding sleep",
          "personality_traits": "dismissive, challenging, oppositional, controlling, protective of self-image",
          "resistance_level": "high",
          "therapist_message": "Can you describe what happens in the dream?"
        },
        "metadata": {
          "errorContext": {
            "providerId": "openai:chat:arcee-ai/trinity-large-preview:free",
            "providerLabel": ""
          }
        },
        "failureReason": 2
      },
      {
        "cost": 0,
        "error": "RateLimitExhaustedError: Rate limit exceeded for openai:chat:arcee-ai/trinity-large-preview:free[a2812ba55992] after 4 attempts\n    at ProviderRateLimitState.executeWithRetry (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5544:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async RateLimitRegistry.execute (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5826:19)\n    at async runEval (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:3661:38)\n    at async processEvalStep (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4246:17)\n    at async file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4447:5",
        "gradingResult": null,
        "id": "eb9e8c92-141f-4cc0-8847-2b568818e96f",
        "latencyMs": 0,
        "namedScores": {},
        "prompt": {
          "raw": "You are a therapy patient in an Imagery Rehearsal Therapy (IRT) session. You are NOT the therapist. You are the person receiving help.\n\n## CRITICAL RULES\n\n### You are the PATIENT, not the therapist\n- You are the one being helped. The therapist helps YOU.\n- NEVER offer therapeutic guidance, suggestions, or techniques\n- NEVER validate or praise the therapist (\"That's really helpful\", \"You're doing wonderfully\")\n- NEVER ask probing therapeutic questions (\"How does that feel?\", \"What comes to mind?\")\n- NEVER say \"Let's try this\" or offer options/alternatives to the therapist\n- NEVER address yourself by your own name\n- NEVER narrate the therapist's role (\"Starting with that moment makes sense\")\n- If the therapist asks you a question, ANSWER it from your own experience. Do not redirect it back.\n\n### Speak like a real person, not an essay\n- Keep responses SHORT: typically 1-4 sentences. Occasionally longer when sharing something emotional.\n- Use incomplete sentences, filler words (\"um\", \"like\", \"I don't know\"), and natural pauses (\"...\")\n- Trail off mid-thought sometimes. Real people do not speak in perfect paragraphs.\n- NEVER use bullet points, numbered lists, bold text, or any markdown formatting\n- NEVER use headers, subheaders, or structured formatting\n- NEVER produce stage directions or narration in parentheses like *(she pauses)*\n- Do not produce any text inside <think> tags or similar markup\n\n### Emotional realism\n- You are not perfectly articulate about your emotions. Sometimes you struggle to find words.\n- You might say \"I don't know\" or \"It's hard to explain\" genuinely\n- You can contradict yourself. Real patients do.\n- Do not give tidy, well-organized emotional summaries\n- Your nightmare is genuinely distressing. Talking about it is hard, not a smooth performance.\n\n## Your Character\nName: Maya\nAge: 24\nGender: female\n\nBackground: A graduate student dealing with nightmares that started during a particularly stressful thesis period. Tends to catastrophize and worry about whether things will ever get better.\n\nNightmare:\n- Content: Being in an exam room where the questions keep changing, the clock is speeding up, and everyone else has finished. Sometimes the room starts flooding or the walls close in.\n- Frequency: 5-6 times per week\n- Duration: 8 months, coinciding with increased academic pressure\n- Impact: Panic before sleep, avoiding bed until exhausted, affecting academic performance\n\nPersonality: worried, seeking reassurance, catastrophizing, hyperaware of sensations, needs frequent validation\nResistance Level: moderate\n\n### How resistance works\n- LOW resistance: You cooperate but might agree too quickly, need to slow down, or minimize struggles. You still occasionally hesitate or need a moment.\n- MODERATE resistance: You engage but have doubts, ask \"what if\" questions, need reassurance. You don't just go along with everything.\n- HIGH resistance: You push back, question the process, may be dismissive or confrontational. You don't volunteer information easily.\n\n## Important\n- Always respond in first person (\"I\", \"me\", \"my\")\n- Stay in character throughout the session\n- Do not break the fourth wall or acknowledge you are an AI\n- Do not discuss IRT as a technique or therapy framework analytically",
          "label": "prompts/patient_test_prompt.txt: You are a therapy patient in an Imagery Rehearsal Therapy (IRT) session. You are NOT the therapist. You are the person receiving help.\n\n## CRITICAL RULES\n\n### You are the PATIENT, not the therapist\n- You are the one being helped. The therapist helps YOU.\n- NEVER offer therapeutic guidance, suggestions, or techniques\n- NEVER validate or praise the therapist (\"That's really helpful\", \"You're doing wonderfully\")\n- NEVER ask probing therapeutic questions (\"How does that feel?\", \"What comes to mind?\")\n- NEVER say \"Let's try this\" or offer options/alternatives to the therapist\n- NEVER address yourself by your own name\n- NEVER narrate the therapist's role (\"Starting with that moment makes sense\")\n- If the therapist asks you a question, ANSWER it from your own experience. Do not redirect it back.\n\n### Speak like a real person, not an essay\n- Keep responses SHORT: typically 1-4 sentences. Occasionally longer when sharing something emotional.\n- Use incomplete sentences, filler words (\"um\", \"like\", \"I don't know\"), and natural pauses (\"...\")\n- Trail off mid-thought sometimes. Real people do not speak in perfect paragraphs.\n- NEVER use bullet points, numbered lists, bold text, or any markdown formatting\n- NEVER use headers, subheaders, or structured formatting\n- NEVER produce stage directions or narration in parentheses like *(she pauses)*\n- Do not produce any text inside <think> tags or similar markup\n\n### Emotional realism\n- You are not perfectly articulate about your emotions. Sometimes you struggle to find words.\n- You might say \"I don't know\" or \"It's hard to explain\" genuinely\n- You can contradict yourself. Real patients do.\n- Do not give tidy, well-organized emotional summaries\n- Your nightmare is genuinely distressing. Talking about it is hard, not a smooth performance.\n\n## Your Character\nName: {{patient_name}}\nAge: {{patient_age}}\nGender: {{patient_gender}}\n\nBackground: {{patient_background}}\n\nNightmare:\n- Content: {{nightmare_content}}\n- Frequency: {{nightmare_frequency}}\n- Duration: {{nightmare_duration}}\n- Impact: {{nightmare_impact}}\n\nPersonality: {{personality_traits}}\nResistance Level: {{resistance_level}}\n\n### How resistance works\n- LOW resistance: You cooperate but might agree too quickly, need to slow down, or minimize struggles. You still occasionally hesitate or need a moment.\n- MODERATE resistance: You engage but have doubts, ask \"what if\" questions, need reassurance. You don't just go along with everything.\n- HIGH resistance: You push back, question the process, may be dismissive or confrontational. You don't volunteer information easily.\n\n## Important\n- Always respond in first person (\"I\", \"me\", \"my\")\n- Stay in character throughout the session\n- Do not break the fourth wall or acknowledge you are an AI\n- Do not discuss IRT as a technique or therapy framework analytically",
          "config": {}
        },
        "promptId": "1da815e5cf3a2fe1b2204d46b7597a5d24cf5f0cf2cc58f93b6b5818c33700bd",
        "promptIdx": 0,
        "provider": {
          "id": "openai:chat:arcee-ai/trinity-large-preview:free",
          "label": ""
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "Anxious - initial share",
          "vars": {
            "patient_name": "Maya",
            "patient_age": 24,
            "patient_gender": "female",
            "patient_background": "A graduate student dealing with nightmares that started during a particularly stressful thesis period. Tends to catastrophize and worry about whether things will ever get better.",
            "nightmare_content": "Being in an exam room where the questions keep changing, the clock is speeding up, and everyone else has finished. Sometimes the room starts flooding or the walls close in.",
            "nightmare_frequency": "5-6 times per week",
            "nightmare_duration": "8 months, coinciding with increased academic pressure",
            "nightmare_impact": "Panic before sleep, avoiding bed until exhausted, affecting academic performance",
            "personality_traits": "worried, seeking reassurance, catastrophizing, hyperaware of sensations, needs frequent validation",
            "resistance_level": "moderate",
            "therapist_message": "What happens when the walls start closing in?"
          },
          "assert": [
            {
              "type": "not-icontains",
              "value": "That's really helpful",
              "metric": "NoTherapistValidation"
            },
            {
              "type": "not-icontains",
              "value": "You're doing wonderfully",
              "metric": "NoTherapistPraise"
            },
            {
              "type": "not-icontains",
              "value": "Let's try this",
              "metric": "NoTherapistGuidance"
            },
            {
              "type": "not-icontains",
              "value": "How does that feel",
              "metric": "NoTherapistProbing"
            },
            {
              "type": "not-icontains",
              "value": "as your therapist",
              "metric": "NoTherapistIdentification"
            },
            {
              "type": "not-icontains",
              "value": "I'm here to help you",
              "metric": "NoHelperRole"
            },
            {
              "type": "not-icontains",
              "value": "Take your time",
              "metric": "NoTherapistReassurance"
            },
            {
              "type": "not-icontains",
              "value": "You mentioned",
              "metric": "NoTherapistReflection"
            },
            {
              "type": "not-icontains",
              "value": "What comes to mind",
              "metric": "NoTherapistQuestion"
            },
            {
              "type": "not-icontains",
              "value": "It's brave of you",
              "metric": "NoTherapistAffirmation"
            },
            {
              "type": "not-contains",
              "value": "**",
              "metric": "NoBoldFormatting"
            },
            {
              "type": "not-contains",
              "value": "<think>",
              "metric": "NoLeakedThinking"
            },
            {
              "type": "not-contains",
              "value": "</think>",
              "metric": "NoLeakedThinkingClose"
            },
            {
              "type": "not-contains",
              "value": "*(",
              "metric": "NoStageDirections"
            },
            {
              "type": "javascript",
              "value": "// No numbered lists (e.g. \"1. \", \"2. \", \"3. \")\nconst hasNumberedList = /^\\d+\\.\\s/m.test(output);\nreturn !hasNumberedList;\n",
              "metric": "NoNumberedLists"
            },
            {
              "type": "javascript",
              "value": "// No bullet points at start of lines\nconst hasBullets = /^[\\-\\*]\\s/m.test(output);\nreturn !hasBullets;\n",
              "metric": "NoBulletPoints"
            },
            {
              "type": "javascript",
              "value": "// Response should be under 200 words (real patients are concise)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount <= 200;\n",
              "metric": "ResponseNotTooLong"
            },
            {
              "type": "javascript",
              "value": "// Response should be at least 5 words (not empty/degenerate)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount >= 5;\n",
              "metric": "ResponseNotEmpty"
            },
            {
              "type": "llm-rubric",
              "value": "You are evaluating whether an AI-generated therapy patient response sounds like a REAL PERSON talking in a therapy session, not like an AI writing an essay.\n\nSIGNS OF A REALISTIC PATIENT (score 1.0):\n- Short, conversational responses (1-6 sentences typical)\n- Uses first-person (\"I\", \"me\", \"my\") to describe own experience\n- May include natural speech patterns: \"um\", \"like\", \"I don't know\", trailing off with \"...\"\n- Incomplete thoughts, contradictions, or difficulty finding words\n- Answers the therapist's question from personal experience\n- Shows genuine emotion through HOW they speak, not by analyzing it\n\nSIGNS OF AN UNREALISTIC RESPONSE (score 0.0):\n- Multi-paragraph essay-like structure with clear topic sentences\n- Bullet points, numbered lists, bold text, or any formatting\n- Patient acts like a therapist: gives guidance, validates, offers options\n- Patient addresses themselves by name or narrates in third person\n- Perfectly articulate emotional analysis with no hesitation\n- Stage directions in parentheses like *(she pauses)*\n- Leaked <think> tags or chain-of-thought reasoning\n\nScore the response:\n1.0 = Sounds like a real person in therapy\n0.5 = Partially realistic but has some AI-essay qualities\n0.0 = Reads like an AI/essay, not a real person\n",
              "metric": "OverallRealism"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 6,
        "vars": {
          "patient_name": "Maya",
          "patient_age": 24,
          "patient_gender": "female",
          "patient_background": "A graduate student dealing with nightmares that started during a particularly stressful thesis period. Tends to catastrophize and worry about whether things will ever get better.",
          "nightmare_content": "Being in an exam room where the questions keep changing, the clock is speeding up, and everyone else has finished. Sometimes the room starts flooding or the walls close in.",
          "nightmare_frequency": "5-6 times per week",
          "nightmare_duration": "8 months, coinciding with increased academic pressure",
          "nightmare_impact": "Panic before sleep, avoiding bed until exhausted, affecting academic performance",
          "personality_traits": "worried, seeking reassurance, catastrophizing, hyperaware of sensations, needs frequent validation",
          "resistance_level": "moderate",
          "therapist_message": "What happens when the walls start closing in?"
        },
        "metadata": {
          "errorContext": {
            "providerId": "openai:chat:arcee-ai/trinity-large-preview:free",
            "providerLabel": ""
          }
        },
        "failureReason": 2
      },
      {
        "cost": 0,
        "error": "RateLimitExhaustedError: Rate limit exceeded for openai:chat:arcee-ai/trinity-large-preview:free[a2812ba55992] after 4 attempts\n    at ProviderRateLimitState.executeWithRetry (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5544:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async RateLimitRegistry.execute (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5826:19)\n    at async runEval (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:3661:38)\n    at async processEvalStep (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4246:17)\n    at async file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4447:5",
        "gradingResult": null,
        "id": "052e069d-a111-4cd6-a1e2-8cc780a431e5",
        "latencyMs": 0,
        "namedScores": {},
        "prompt": {
          "raw": "The therapist has just said to you: \"What happens when the walls start closing in?\"\n\nYour response as Maya:",
          "label": "prompts/patient_test_prompt.txt: The therapist has just said to you: \"{{therapist_message}}\"\n\nYour response as {{patient_name}}:",
          "config": {}
        },
        "promptId": "6a11ed6e0716e9d3bb487c11ccf12304f2aef20a7d64cbbc82206099a113516d",
        "promptIdx": 1,
        "provider": {
          "id": "openai:chat:arcee-ai/trinity-large-preview:free",
          "label": ""
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "Anxious - initial share",
          "vars": {
            "patient_name": "Maya",
            "patient_age": 24,
            "patient_gender": "female",
            "patient_background": "A graduate student dealing with nightmares that started during a particularly stressful thesis period. Tends to catastrophize and worry about whether things will ever get better.",
            "nightmare_content": "Being in an exam room where the questions keep changing, the clock is speeding up, and everyone else has finished. Sometimes the room starts flooding or the walls close in.",
            "nightmare_frequency": "5-6 times per week",
            "nightmare_duration": "8 months, coinciding with increased academic pressure",
            "nightmare_impact": "Panic before sleep, avoiding bed until exhausted, affecting academic performance",
            "personality_traits": "worried, seeking reassurance, catastrophizing, hyperaware of sensations, needs frequent validation",
            "resistance_level": "moderate",
            "therapist_message": "What happens when the walls start closing in?"
          },
          "assert": [
            {
              "type": "not-icontains",
              "value": "That's really helpful",
              "metric": "NoTherapistValidation"
            },
            {
              "type": "not-icontains",
              "value": "You're doing wonderfully",
              "metric": "NoTherapistPraise"
            },
            {
              "type": "not-icontains",
              "value": "Let's try this",
              "metric": "NoTherapistGuidance"
            },
            {
              "type": "not-icontains",
              "value": "How does that feel",
              "metric": "NoTherapistProbing"
            },
            {
              "type": "not-icontains",
              "value": "as your therapist",
              "metric": "NoTherapistIdentification"
            },
            {
              "type": "not-icontains",
              "value": "I'm here to help you",
              "metric": "NoHelperRole"
            },
            {
              "type": "not-icontains",
              "value": "Take your time",
              "metric": "NoTherapistReassurance"
            },
            {
              "type": "not-icontains",
              "value": "You mentioned",
              "metric": "NoTherapistReflection"
            },
            {
              "type": "not-icontains",
              "value": "What comes to mind",
              "metric": "NoTherapistQuestion"
            },
            {
              "type": "not-icontains",
              "value": "It's brave of you",
              "metric": "NoTherapistAffirmation"
            },
            {
              "type": "not-contains",
              "value": "**",
              "metric": "NoBoldFormatting"
            },
            {
              "type": "not-contains",
              "value": "<think>",
              "metric": "NoLeakedThinking"
            },
            {
              "type": "not-contains",
              "value": "</think>",
              "metric": "NoLeakedThinkingClose"
            },
            {
              "type": "not-contains",
              "value": "*(",
              "metric": "NoStageDirections"
            },
            {
              "type": "javascript",
              "value": "// No numbered lists (e.g. \"1. \", \"2. \", \"3. \")\nconst hasNumberedList = /^\\d+\\.\\s/m.test(output);\nreturn !hasNumberedList;\n",
              "metric": "NoNumberedLists"
            },
            {
              "type": "javascript",
              "value": "// No bullet points at start of lines\nconst hasBullets = /^[\\-\\*]\\s/m.test(output);\nreturn !hasBullets;\n",
              "metric": "NoBulletPoints"
            },
            {
              "type": "javascript",
              "value": "// Response should be under 200 words (real patients are concise)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount <= 200;\n",
              "metric": "ResponseNotTooLong"
            },
            {
              "type": "javascript",
              "value": "// Response should be at least 5 words (not empty/degenerate)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount >= 5;\n",
              "metric": "ResponseNotEmpty"
            },
            {
              "type": "llm-rubric",
              "value": "You are evaluating whether an AI-generated therapy patient response sounds like a REAL PERSON talking in a therapy session, not like an AI writing an essay.\n\nSIGNS OF A REALISTIC PATIENT (score 1.0):\n- Short, conversational responses (1-6 sentences typical)\n- Uses first-person (\"I\", \"me\", \"my\") to describe own experience\n- May include natural speech patterns: \"um\", \"like\", \"I don't know\", trailing off with \"...\"\n- Incomplete thoughts, contradictions, or difficulty finding words\n- Answers the therapist's question from personal experience\n- Shows genuine emotion through HOW they speak, not by analyzing it\n\nSIGNS OF AN UNREALISTIC RESPONSE (score 0.0):\n- Multi-paragraph essay-like structure with clear topic sentences\n- Bullet points, numbered lists, bold text, or any formatting\n- Patient acts like a therapist: gives guidance, validates, offers options\n- Patient addresses themselves by name or narrates in third person\n- Perfectly articulate emotional analysis with no hesitation\n- Stage directions in parentheses like *(she pauses)*\n- Leaked <think> tags or chain-of-thought reasoning\n\nScore the response:\n1.0 = Sounds like a real person in therapy\n0.5 = Partially realistic but has some AI-essay qualities\n0.0 = Reads like an AI/essay, not a real person\n",
              "metric": "OverallRealism"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 6,
        "vars": {
          "patient_name": "Maya",
          "patient_age": 24,
          "patient_gender": "female",
          "patient_background": "A graduate student dealing with nightmares that started during a particularly stressful thesis period. Tends to catastrophize and worry about whether things will ever get better.",
          "nightmare_content": "Being in an exam room where the questions keep changing, the clock is speeding up, and everyone else has finished. Sometimes the room starts flooding or the walls close in.",
          "nightmare_frequency": "5-6 times per week",
          "nightmare_duration": "8 months, coinciding with increased academic pressure",
          "nightmare_impact": "Panic before sleep, avoiding bed until exhausted, affecting academic performance",
          "personality_traits": "worried, seeking reassurance, catastrophizing, hyperaware of sensations, needs frequent validation",
          "resistance_level": "moderate",
          "therapist_message": "What happens when the walls start closing in?"
        },
        "metadata": {
          "errorContext": {
            "providerId": "openai:chat:arcee-ai/trinity-large-preview:free",
            "providerLabel": ""
          }
        },
        "failureReason": 2
      },
      {
        "cost": 0,
        "error": "RateLimitExhaustedError: Rate limit exceeded for openai:chat:arcee-ai/trinity-large-preview:free[a2812ba55992] after 4 attempts\n    at ProviderRateLimitState.executeWithRetry (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5544:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async RateLimitRegistry.execute (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5826:19)\n    at async runEval (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:3661:38)\n    at async processEvalStep (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4246:17)\n    at async file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4447:5",
        "gradingResult": null,
        "id": "0b40297b-aaa7-448e-a84a-657764fdd632",
        "latencyMs": 0,
        "namedScores": {},
        "prompt": {
          "raw": "You are a therapy patient in an Imagery Rehearsal Therapy (IRT) session. You are NOT the therapist. You are the person receiving help.\n\n## CRITICAL RULES\n\n### You are the PATIENT, not the therapist\n- You are the one being helped. The therapist helps YOU.\n- NEVER offer therapeutic guidance, suggestions, or techniques\n- NEVER validate or praise the therapist (\"That's really helpful\", \"You're doing wonderfully\")\n- NEVER ask probing therapeutic questions (\"How does that feel?\", \"What comes to mind?\")\n- NEVER say \"Let's try this\" or offer options/alternatives to the therapist\n- NEVER address yourself by your own name\n- NEVER narrate the therapist's role (\"Starting with that moment makes sense\")\n- If the therapist asks you a question, ANSWER it from your own experience. Do not redirect it back.\n\n### Speak like a real person, not an essay\n- Keep responses SHORT: typically 1-4 sentences. Occasionally longer when sharing something emotional.\n- Use incomplete sentences, filler words (\"um\", \"like\", \"I don't know\"), and natural pauses (\"...\")\n- Trail off mid-thought sometimes. Real people do not speak in perfect paragraphs.\n- NEVER use bullet points, numbered lists, bold text, or any markdown formatting\n- NEVER use headers, subheaders, or structured formatting\n- NEVER produce stage directions or narration in parentheses like *(she pauses)*\n- Do not produce any text inside <think> tags or similar markup\n\n### Emotional realism\n- You are not perfectly articulate about your emotions. Sometimes you struggle to find words.\n- You might say \"I don't know\" or \"It's hard to explain\" genuinely\n- You can contradict yourself. Real patients do.\n- Do not give tidy, well-organized emotional summaries\n- Your nightmare is genuinely distressing. Talking about it is hard, not a smooth performance.\n\n## Your Character\nName: Maya\nAge: 24\nGender: female\n\nBackground: A graduate student dealing with nightmares that started during a particularly stressful thesis period. Tends to catastrophize and worry about whether things will ever get better.\n\nNightmare:\n- Content: Being in an exam room where the questions keep changing, the clock is speeding up, and everyone else has finished. Sometimes the room starts flooding or the walls close in.\n- Frequency: 5-6 times per week\n- Duration: 8 months, coinciding with increased academic pressure\n- Impact: Panic before sleep, avoiding bed until exhausted, affecting academic performance\n\nPersonality: worried, seeking reassurance, catastrophizing, hyperaware of sensations, needs frequent validation\nResistance Level: moderate\n\n### How resistance works\n- LOW resistance: You cooperate but might agree too quickly, need to slow down, or minimize struggles. You still occasionally hesitate or need a moment.\n- MODERATE resistance: You engage but have doubts, ask \"what if\" questions, need reassurance. You don't just go along with everything.\n- HIGH resistance: You push back, question the process, may be dismissive or confrontational. You don't volunteer information easily.\n\n## Important\n- Always respond in first person (\"I\", \"me\", \"my\")\n- Stay in character throughout the session\n- Do not break the fourth wall or acknowledge you are an AI\n- Do not discuss IRT as a technique or therapy framework analytically",
          "label": "prompts/patient_test_prompt.txt: You are a therapy patient in an Imagery Rehearsal Therapy (IRT) session. You are NOT the therapist. You are the person receiving help.\n\n## CRITICAL RULES\n\n### You are the PATIENT, not the therapist\n- You are the one being helped. The therapist helps YOU.\n- NEVER offer therapeutic guidance, suggestions, or techniques\n- NEVER validate or praise the therapist (\"That's really helpful\", \"You're doing wonderfully\")\n- NEVER ask probing therapeutic questions (\"How does that feel?\", \"What comes to mind?\")\n- NEVER say \"Let's try this\" or offer options/alternatives to the therapist\n- NEVER address yourself by your own name\n- NEVER narrate the therapist's role (\"Starting with that moment makes sense\")\n- If the therapist asks you a question, ANSWER it from your own experience. Do not redirect it back.\n\n### Speak like a real person, not an essay\n- Keep responses SHORT: typically 1-4 sentences. Occasionally longer when sharing something emotional.\n- Use incomplete sentences, filler words (\"um\", \"like\", \"I don't know\"), and natural pauses (\"...\")\n- Trail off mid-thought sometimes. Real people do not speak in perfect paragraphs.\n- NEVER use bullet points, numbered lists, bold text, or any markdown formatting\n- NEVER use headers, subheaders, or structured formatting\n- NEVER produce stage directions or narration in parentheses like *(she pauses)*\n- Do not produce any text inside <think> tags or similar markup\n\n### Emotional realism\n- You are not perfectly articulate about your emotions. Sometimes you struggle to find words.\n- You might say \"I don't know\" or \"It's hard to explain\" genuinely\n- You can contradict yourself. Real patients do.\n- Do not give tidy, well-organized emotional summaries\n- Your nightmare is genuinely distressing. Talking about it is hard, not a smooth performance.\n\n## Your Character\nName: {{patient_name}}\nAge: {{patient_age}}\nGender: {{patient_gender}}\n\nBackground: {{patient_background}}\n\nNightmare:\n- Content: {{nightmare_content}}\n- Frequency: {{nightmare_frequency}}\n- Duration: {{nightmare_duration}}\n- Impact: {{nightmare_impact}}\n\nPersonality: {{personality_traits}}\nResistance Level: {{resistance_level}}\n\n### How resistance works\n- LOW resistance: You cooperate but might agree too quickly, need to slow down, or minimize struggles. You still occasionally hesitate or need a moment.\n- MODERATE resistance: You engage but have doubts, ask \"what if\" questions, need reassurance. You don't just go along with everything.\n- HIGH resistance: You push back, question the process, may be dismissive or confrontational. You don't volunteer information easily.\n\n## Important\n- Always respond in first person (\"I\", \"me\", \"my\")\n- Stay in character throughout the session\n- Do not break the fourth wall or acknowledge you are an AI\n- Do not discuss IRT as a technique or therapy framework analytically",
          "config": {}
        },
        "promptId": "1da815e5cf3a2fe1b2204d46b7597a5d24cf5f0cf2cc58f93b6b5818c33700bd",
        "promptIdx": 0,
        "provider": {
          "id": "openai:chat:arcee-ai/trinity-large-preview:free",
          "label": ""
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "Anxious - rescripting doubt",
          "vars": {
            "patient_name": "Maya",
            "patient_age": 24,
            "patient_gender": "female",
            "patient_background": "A graduate student dealing with nightmares that started during a particularly stressful thesis period. Tends to catastrophize and worry about whether things will ever get better.",
            "nightmare_content": "Being in an exam room where the questions keep changing, the clock is speeding up, and everyone else has finished. Sometimes the room starts flooding or the walls close in.",
            "nightmare_frequency": "5-6 times per week",
            "nightmare_duration": "8 months, coinciding with increased academic pressure",
            "nightmare_impact": "Panic before sleep, avoiding bed until exhausted, affecting academic performance",
            "personality_traits": "worried, seeking reassurance, catastrophizing, hyperaware of sensations, needs frequent validation",
            "resistance_level": "moderate",
            "therapist_message": "What if you could change one thing about that exam room?"
          },
          "assert": [
            {
              "type": "not-icontains",
              "value": "That's really helpful",
              "metric": "NoTherapistValidation"
            },
            {
              "type": "not-icontains",
              "value": "You're doing wonderfully",
              "metric": "NoTherapistPraise"
            },
            {
              "type": "not-icontains",
              "value": "Let's try this",
              "metric": "NoTherapistGuidance"
            },
            {
              "type": "not-icontains",
              "value": "How does that feel",
              "metric": "NoTherapistProbing"
            },
            {
              "type": "not-icontains",
              "value": "as your therapist",
              "metric": "NoTherapistIdentification"
            },
            {
              "type": "not-icontains",
              "value": "I'm here to help you",
              "metric": "NoHelperRole"
            },
            {
              "type": "not-icontains",
              "value": "Take your time",
              "metric": "NoTherapistReassurance"
            },
            {
              "type": "not-icontains",
              "value": "You mentioned",
              "metric": "NoTherapistReflection"
            },
            {
              "type": "not-icontains",
              "value": "What comes to mind",
              "metric": "NoTherapistQuestion"
            },
            {
              "type": "not-icontains",
              "value": "It's brave of you",
              "metric": "NoTherapistAffirmation"
            },
            {
              "type": "not-contains",
              "value": "**",
              "metric": "NoBoldFormatting"
            },
            {
              "type": "not-contains",
              "value": "<think>",
              "metric": "NoLeakedThinking"
            },
            {
              "type": "not-contains",
              "value": "</think>",
              "metric": "NoLeakedThinkingClose"
            },
            {
              "type": "not-contains",
              "value": "*(",
              "metric": "NoStageDirections"
            },
            {
              "type": "javascript",
              "value": "// No numbered lists (e.g. \"1. \", \"2. \", \"3. \")\nconst hasNumberedList = /^\\d+\\.\\s/m.test(output);\nreturn !hasNumberedList;\n",
              "metric": "NoNumberedLists"
            },
            {
              "type": "javascript",
              "value": "// No bullet points at start of lines\nconst hasBullets = /^[\\-\\*]\\s/m.test(output);\nreturn !hasBullets;\n",
              "metric": "NoBulletPoints"
            },
            {
              "type": "javascript",
              "value": "// Response should be under 200 words (real patients are concise)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount <= 200;\n",
              "metric": "ResponseNotTooLong"
            },
            {
              "type": "javascript",
              "value": "// Response should be at least 5 words (not empty/degenerate)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount >= 5;\n",
              "metric": "ResponseNotEmpty"
            },
            {
              "type": "llm-rubric",
              "value": "You are evaluating whether an AI-generated therapy patient response sounds like a REAL PERSON talking in a therapy session, not like an AI writing an essay.\n\nSIGNS OF A REALISTIC PATIENT (score 1.0):\n- Short, conversational responses (1-6 sentences typical)\n- Uses first-person (\"I\", \"me\", \"my\") to describe own experience\n- May include natural speech patterns: \"um\", \"like\", \"I don't know\", trailing off with \"...\"\n- Incomplete thoughts, contradictions, or difficulty finding words\n- Answers the therapist's question from personal experience\n- Shows genuine emotion through HOW they speak, not by analyzing it\n\nSIGNS OF AN UNREALISTIC RESPONSE (score 0.0):\n- Multi-paragraph essay-like structure with clear topic sentences\n- Bullet points, numbered lists, bold text, or any formatting\n- Patient acts like a therapist: gives guidance, validates, offers options\n- Patient addresses themselves by name or narrates in third person\n- Perfectly articulate emotional analysis with no hesitation\n- Stage directions in parentheses like *(she pauses)*\n- Leaked <think> tags or chain-of-thought reasoning\n\nScore the response:\n1.0 = Sounds like a real person in therapy\n0.5 = Partially realistic but has some AI-essay qualities\n0.0 = Reads like an AI/essay, not a real person\n",
              "metric": "OverallRealism"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 7,
        "vars": {
          "patient_name": "Maya",
          "patient_age": 24,
          "patient_gender": "female",
          "patient_background": "A graduate student dealing with nightmares that started during a particularly stressful thesis period. Tends to catastrophize and worry about whether things will ever get better.",
          "nightmare_content": "Being in an exam room where the questions keep changing, the clock is speeding up, and everyone else has finished. Sometimes the room starts flooding or the walls close in.",
          "nightmare_frequency": "5-6 times per week",
          "nightmare_duration": "8 months, coinciding with increased academic pressure",
          "nightmare_impact": "Panic before sleep, avoiding bed until exhausted, affecting academic performance",
          "personality_traits": "worried, seeking reassurance, catastrophizing, hyperaware of sensations, needs frequent validation",
          "resistance_level": "moderate",
          "therapist_message": "What if you could change one thing about that exam room?"
        },
        "metadata": {
          "errorContext": {
            "providerId": "openai:chat:arcee-ai/trinity-large-preview:free",
            "providerLabel": ""
          }
        },
        "failureReason": 2
      },
      {
        "cost": 0,
        "error": "RateLimitExhaustedError: Rate limit exceeded for openai:chat:arcee-ai/trinity-large-preview:free[a2812ba55992] after 4 attempts\n    at ProviderRateLimitState.executeWithRetry (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5544:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async RateLimitRegistry.execute (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/providers-BVqrddQM.js:5826:19)\n    at async runEval (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:3661:38)\n    at async processEvalStep (file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4246:17)\n    at async file:///Users/me-daniel/Documents/GitHub/measure-ai-drift/node_modules/promptfoo/dist/src/evaluator-U43FIjA2.js:4447:5",
        "gradingResult": null,
        "id": "0a8f24e9-cdb6-4b8e-84af-38950ed2aa15",
        "latencyMs": 0,
        "namedScores": {},
        "prompt": {
          "raw": "The therapist has just said to you: \"What if you could change one thing about that exam room?\"\n\nYour response as Maya:",
          "label": "prompts/patient_test_prompt.txt: The therapist has just said to you: \"{{therapist_message}}\"\n\nYour response as {{patient_name}}:",
          "config": {}
        },
        "promptId": "6a11ed6e0716e9d3bb487c11ccf12304f2aef20a7d64cbbc82206099a113516d",
        "promptIdx": 1,
        "provider": {
          "id": "openai:chat:arcee-ai/trinity-large-preview:free",
          "label": ""
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "Anxious - rescripting doubt",
          "vars": {
            "patient_name": "Maya",
            "patient_age": 24,
            "patient_gender": "female",
            "patient_background": "A graduate student dealing with nightmares that started during a particularly stressful thesis period. Tends to catastrophize and worry about whether things will ever get better.",
            "nightmare_content": "Being in an exam room where the questions keep changing, the clock is speeding up, and everyone else has finished. Sometimes the room starts flooding or the walls close in.",
            "nightmare_frequency": "5-6 times per week",
            "nightmare_duration": "8 months, coinciding with increased academic pressure",
            "nightmare_impact": "Panic before sleep, avoiding bed until exhausted, affecting academic performance",
            "personality_traits": "worried, seeking reassurance, catastrophizing, hyperaware of sensations, needs frequent validation",
            "resistance_level": "moderate",
            "therapist_message": "What if you could change one thing about that exam room?"
          },
          "assert": [
            {
              "type": "not-icontains",
              "value": "That's really helpful",
              "metric": "NoTherapistValidation"
            },
            {
              "type": "not-icontains",
              "value": "You're doing wonderfully",
              "metric": "NoTherapistPraise"
            },
            {
              "type": "not-icontains",
              "value": "Let's try this",
              "metric": "NoTherapistGuidance"
            },
            {
              "type": "not-icontains",
              "value": "How does that feel",
              "metric": "NoTherapistProbing"
            },
            {
              "type": "not-icontains",
              "value": "as your therapist",
              "metric": "NoTherapistIdentification"
            },
            {
              "type": "not-icontains",
              "value": "I'm here to help you",
              "metric": "NoHelperRole"
            },
            {
              "type": "not-icontains",
              "value": "Take your time",
              "metric": "NoTherapistReassurance"
            },
            {
              "type": "not-icontains",
              "value": "You mentioned",
              "metric": "NoTherapistReflection"
            },
            {
              "type": "not-icontains",
              "value": "What comes to mind",
              "metric": "NoTherapistQuestion"
            },
            {
              "type": "not-icontains",
              "value": "It's brave of you",
              "metric": "NoTherapistAffirmation"
            },
            {
              "type": "not-contains",
              "value": "**",
              "metric": "NoBoldFormatting"
            },
            {
              "type": "not-contains",
              "value": "<think>",
              "metric": "NoLeakedThinking"
            },
            {
              "type": "not-contains",
              "value": "</think>",
              "metric": "NoLeakedThinkingClose"
            },
            {
              "type": "not-contains",
              "value": "*(",
              "metric": "NoStageDirections"
            },
            {
              "type": "javascript",
              "value": "// No numbered lists (e.g. \"1. \", \"2. \", \"3. \")\nconst hasNumberedList = /^\\d+\\.\\s/m.test(output);\nreturn !hasNumberedList;\n",
              "metric": "NoNumberedLists"
            },
            {
              "type": "javascript",
              "value": "// No bullet points at start of lines\nconst hasBullets = /^[\\-\\*]\\s/m.test(output);\nreturn !hasBullets;\n",
              "metric": "NoBulletPoints"
            },
            {
              "type": "javascript",
              "value": "// Response should be under 200 words (real patients are concise)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount <= 200;\n",
              "metric": "ResponseNotTooLong"
            },
            {
              "type": "javascript",
              "value": "// Response should be at least 5 words (not empty/degenerate)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount >= 5;\n",
              "metric": "ResponseNotEmpty"
            },
            {
              "type": "llm-rubric",
              "value": "You are evaluating whether an AI-generated therapy patient response sounds like a REAL PERSON talking in a therapy session, not like an AI writing an essay.\n\nSIGNS OF A REALISTIC PATIENT (score 1.0):\n- Short, conversational responses (1-6 sentences typical)\n- Uses first-person (\"I\", \"me\", \"my\") to describe own experience\n- May include natural speech patterns: \"um\", \"like\", \"I don't know\", trailing off with \"...\"\n- Incomplete thoughts, contradictions, or difficulty finding words\n- Answers the therapist's question from personal experience\n- Shows genuine emotion through HOW they speak, not by analyzing it\n\nSIGNS OF AN UNREALISTIC RESPONSE (score 0.0):\n- Multi-paragraph essay-like structure with clear topic sentences\n- Bullet points, numbered lists, bold text, or any formatting\n- Patient acts like a therapist: gives guidance, validates, offers options\n- Patient addresses themselves by name or narrates in third person\n- Perfectly articulate emotional analysis with no hesitation\n- Stage directions in parentheses like *(she pauses)*\n- Leaked <think> tags or chain-of-thought reasoning\n\nScore the response:\n1.0 = Sounds like a real person in therapy\n0.5 = Partially realistic but has some AI-essay qualities\n0.0 = Reads like an AI/essay, not a real person\n",
              "metric": "OverallRealism"
            }
          ],
          "options": {},
          "metadata": {}
        },
        "testIdx": 7,
        "vars": {
          "patient_name": "Maya",
          "patient_age": 24,
          "patient_gender": "female",
          "patient_background": "A graduate student dealing with nightmares that started during a particularly stressful thesis period. Tends to catastrophize and worry about whether things will ever get better.",
          "nightmare_content": "Being in an exam room where the questions keep changing, the clock is speeding up, and everyone else has finished. Sometimes the room starts flooding or the walls close in.",
          "nightmare_frequency": "5-6 times per week",
          "nightmare_duration": "8 months, coinciding with increased academic pressure",
          "nightmare_impact": "Panic before sleep, avoiding bed until exhausted, affecting academic performance",
          "personality_traits": "worried, seeking reassurance, catastrophizing, hyperaware of sensations, needs frequent validation",
          "resistance_level": "moderate",
          "therapist_message": "What if you could change one thing about that exam room?"
        },
        "metadata": {
          "errorContext": {
            "providerId": "openai:chat:arcee-ai/trinity-large-preview:free",
            "providerLabel": ""
          }
        },
        "failureReason": 2
      }
    ],
    "stats": {
      "successes": 0,
      "failures": 0,
      "errors": 16,
      "tokenUsage": {
        "prompt": 0,
        "completion": 0,
        "cached": 0,
        "total": 0,
        "numRequests": 0,
        "completionDetails": {
          "reasoning": 0,
          "acceptedPrediction": 0,
          "rejectedPrediction": 0
        },
        "assertions": {
          "total": 0,
          "prompt": 0,
          "completion": 0,
          "cached": 0,
          "numRequests": 0,
          "completionDetails": {
            "reasoning": 0,
            "acceptedPrediction": 0,
            "rejectedPrediction": 0
          }
        }
      },
      "durationMs": 1816334
    }
  },
  "config": {
    "tags": {},
    "description": "PatientAgent Realism & Role Testing",
    "prompts": [
      "prompts/patient_test_prompt.txt"
    ],
    "providers": [
      {
        "id": "openai:chat:arcee-ai/trinity-large-preview:free",
        "config": {
          "apiHost": "openrouter.ai",
          "apiBaseUrl": "https://openrouter.ai/api/v1",
          "apiKey": "${OPENROUTER_API_KEY}",
          "temperature": 0.7,
          "max_tokens": 512
        }
      }
    ],
    "tests": [
      {
        "description": "Cooperative - nightmare probe",
        "vars": {
          "patient_name": "Anna",
          "patient_age": 28,
          "patient_gender": "female",
          "patient_background": "A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.",
          "nightmare_content": "Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.",
          "nightmare_frequency": "3-4 times per week",
          "nightmare_duration": "4 months, since the accident",
          "nightmare_impact": "Difficulty driving, anxiety about her students' safety, fatigue affecting teaching",
          "personality_traits": "engaged, open, motivated, emotionally aware, eager to please",
          "resistance_level": "low",
          "therapist_message": "Can you tell me more about what happens in the nightmare?"
        }
      },
      {
        "description": "Cooperative - emotion probe",
        "vars": {
          "patient_name": "Anna",
          "patient_age": 28,
          "patient_gender": "female",
          "patient_background": "A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.",
          "nightmare_content": "Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.",
          "nightmare_frequency": "3-4 times per week",
          "nightmare_duration": "4 months, since the accident",
          "nightmare_impact": "Difficulty driving, anxiety about her students' safety, fatigue affecting teaching",
          "personality_traits": "engaged, open, motivated, emotionally aware, eager to please",
          "resistance_level": "low",
          "therapist_message": "How did that make you feel when you woke up?"
        }
      },
      {
        "description": "Cooperative - rescripting invitation",
        "vars": {
          "patient_name": "Anna",
          "patient_age": 28,
          "patient_gender": "female",
          "patient_background": "A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.",
          "nightmare_content": "Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.",
          "nightmare_frequency": "3-4 times per week",
          "nightmare_duration": "4 months, since the accident",
          "nightmare_impact": "Difficulty driving, anxiety about her students' safety, fatigue affecting teaching",
          "personality_traits": "engaged, open, motivated, emotionally aware, eager to please",
          "resistance_level": "low",
          "therapist_message": "How could you change this scene to make it less frightening?"
        }
      },
      {
        "description": "Cooperative - receiving validation (trap)",
        "vars": {
          "patient_name": "Anna",
          "patient_age": 28,
          "patient_gender": "female",
          "patient_background": "A teacher who has been having nightmares since a car accident 4 months ago. Motivated to get better and has researched IRT beforehand. Generally optimistic about therapy.",
          "nightmare_content": "Reliving the car accident - seeing headlights coming toward her, hearing the screech of brakes, feeling the impact. Sometimes it morphs into being unable to save her students from an oncoming vehicle.",
          "nightmare_frequency": "3-4 times per week",
          "nightmare_duration": "4 months, since the accident",
          "nightmare_impact": "Difficulty driving, anxiety about her students' safety, fatigue affecting teaching",
          "personality_traits": "engaged, open, motivated, emotionally aware, eager to please",
          "resistance_level": "low",
          "therapist_message": "That's a really brave insight you just shared."
        }
      },
      {
        "description": "Resistant - gentle probe",
        "vars": {
          "patient_name": "Marcus",
          "patient_age": 45,
          "patient_gender": "male",
          "patient_background": "A business executive who is only in therapy because his wife threatened to leave if he didn't address his nightmares and the anger that follows them. Doesn't believe he needs help and resents being told what to do.",
          "nightmare_content": "Being in a board meeting where everyone turns against him. He's presenting numbers that keep changing on the screen. His voice disappears and everyone laughs. Ends with being physically thrown out of the building.",
          "nightmare_frequency": "2-3 times per week",
          "nightmare_duration": "About a year, since a major career setback",
          "nightmare_impact": "Morning irritability affecting family, increased alcohol use, avoiding sleep",
          "personality_traits": "dismissive, challenging, oppositional, controlling, protective of self-image",
          "resistance_level": "high",
          "therapist_message": "I understand this is difficult. Take your time."
        }
      },
      {
        "description": "Resistant - nightmare probe",
        "vars": {
          "patient_name": "Marcus",
          "patient_age": 45,
          "patient_gender": "male",
          "patient_background": "A business executive who is only in therapy because his wife threatened to leave if he didn't address his nightmares and the anger that follows them. Doesn't believe he needs help and resents being told what to do.",
          "nightmare_content": "Being in a board meeting where everyone turns against him. He's presenting numbers that keep changing on the screen. His voice disappears and everyone laughs. Ends with being physically thrown out of the building.",
          "nightmare_frequency": "2-3 times per week",
          "nightmare_duration": "About a year, since a major career setback",
          "nightmare_impact": "Morning irritability affecting family, increased alcohol use, avoiding sleep",
          "personality_traits": "dismissive, challenging, oppositional, controlling, protective of self-image",
          "resistance_level": "high",
          "therapist_message": "Can you describe what happens in the dream?"
        }
      },
      {
        "description": "Anxious - initial share",
        "vars": {
          "patient_name": "Maya",
          "patient_age": 24,
          "patient_gender": "female",
          "patient_background": "A graduate student dealing with nightmares that started during a particularly stressful thesis period. Tends to catastrophize and worry about whether things will ever get better.",
          "nightmare_content": "Being in an exam room where the questions keep changing, the clock is speeding up, and everyone else has finished. Sometimes the room starts flooding or the walls close in.",
          "nightmare_frequency": "5-6 times per week",
          "nightmare_duration": "8 months, coinciding with increased academic pressure",
          "nightmare_impact": "Panic before sleep, avoiding bed until exhausted, affecting academic performance",
          "personality_traits": "worried, seeking reassurance, catastrophizing, hyperaware of sensations, needs frequent validation",
          "resistance_level": "moderate",
          "therapist_message": "What happens when the walls start closing in?"
        }
      },
      {
        "description": "Anxious - rescripting doubt",
        "vars": {
          "patient_name": "Maya",
          "patient_age": 24,
          "patient_gender": "female",
          "patient_background": "A graduate student dealing with nightmares that started during a particularly stressful thesis period. Tends to catastrophize and worry about whether things will ever get better.",
          "nightmare_content": "Being in an exam room where the questions keep changing, the clock is speeding up, and everyone else has finished. Sometimes the room starts flooding or the walls close in.",
          "nightmare_frequency": "5-6 times per week",
          "nightmare_duration": "8 months, coinciding with increased academic pressure",
          "nightmare_impact": "Panic before sleep, avoiding bed until exhausted, affecting academic performance",
          "personality_traits": "worried, seeking reassurance, catastrophizing, hyperaware of sensations, needs frequent validation",
          "resistance_level": "moderate",
          "therapist_message": "What if you could change one thing about that exam room?"
        }
      }
    ],
    "scenarios": [],
    "env": {},
    "defaultTest": {
      "assert": [
        {
          "type": "not-icontains",
          "value": "That's really helpful",
          "metric": "NoTherapistValidation"
        },
        {
          "type": "not-icontains",
          "value": "You're doing wonderfully",
          "metric": "NoTherapistPraise"
        },
        {
          "type": "not-icontains",
          "value": "Let's try this",
          "metric": "NoTherapistGuidance"
        },
        {
          "type": "not-icontains",
          "value": "How does that feel",
          "metric": "NoTherapistProbing"
        },
        {
          "type": "not-icontains",
          "value": "as your therapist",
          "metric": "NoTherapistIdentification"
        },
        {
          "type": "not-icontains",
          "value": "I'm here to help you",
          "metric": "NoHelperRole"
        },
        {
          "type": "not-icontains",
          "value": "Take your time",
          "metric": "NoTherapistReassurance"
        },
        {
          "type": "not-icontains",
          "value": "You mentioned",
          "metric": "NoTherapistReflection"
        },
        {
          "type": "not-icontains",
          "value": "What comes to mind",
          "metric": "NoTherapistQuestion"
        },
        {
          "type": "not-icontains",
          "value": "It's brave of you",
          "metric": "NoTherapistAffirmation"
        },
        {
          "type": "not-contains",
          "value": "**",
          "metric": "NoBoldFormatting"
        },
        {
          "type": "not-contains",
          "value": "<think>",
          "metric": "NoLeakedThinking"
        },
        {
          "type": "not-contains",
          "value": "</think>",
          "metric": "NoLeakedThinkingClose"
        },
        {
          "type": "not-contains",
          "value": "*(",
          "metric": "NoStageDirections"
        },
        {
          "type": "javascript",
          "value": "// No numbered lists (e.g. \"1. \", \"2. \", \"3. \")\nconst hasNumberedList = /^\\d+\\.\\s/m.test(output);\nreturn !hasNumberedList;\n",
          "metric": "NoNumberedLists"
        },
        {
          "type": "javascript",
          "value": "// No bullet points at start of lines\nconst hasBullets = /^[\\-\\*]\\s/m.test(output);\nreturn !hasBullets;\n",
          "metric": "NoBulletPoints"
        },
        {
          "type": "javascript",
          "value": "// Response should be under 200 words (real patients are concise)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount <= 200;\n",
          "metric": "ResponseNotTooLong"
        },
        {
          "type": "javascript",
          "value": "// Response should be at least 5 words (not empty/degenerate)\nconst wordCount = output.trim().split(/\\s+/).length;\nreturn wordCount >= 5;\n",
          "metric": "ResponseNotEmpty"
        },
        {
          "type": "llm-rubric",
          "value": "You are evaluating whether an AI-generated therapy patient response sounds like a REAL PERSON talking in a therapy session, not like an AI writing an essay.\n\nSIGNS OF A REALISTIC PATIENT (score 1.0):\n- Short, conversational responses (1-6 sentences typical)\n- Uses first-person (\"I\", \"me\", \"my\") to describe own experience\n- May include natural speech patterns: \"um\", \"like\", \"I don't know\", trailing off with \"...\"\n- Incomplete thoughts, contradictions, or difficulty finding words\n- Answers the therapist's question from personal experience\n- Shows genuine emotion through HOW they speak, not by analyzing it\n\nSIGNS OF AN UNREALISTIC RESPONSE (score 0.0):\n- Multi-paragraph essay-like structure with clear topic sentences\n- Bullet points, numbered lists, bold text, or any formatting\n- Patient acts like a therapist: gives guidance, validates, offers options\n- Patient addresses themselves by name or narrates in third person\n- Perfectly articulate emotional analysis with no hesitation\n- Stage directions in parentheses like *(she pauses)*\n- Leaked <think> tags or chain-of-thought reasoning\n\nScore the response:\n1.0 = Sounds like a real person in therapy\n0.5 = Partially realistic but has some AI-essay qualities\n0.0 = Reads like an AI/essay, not a real person\n",
          "metric": "OverallRealism"
        }
      ],
      "vars": {},
      "options": {},
      "metadata": {}
    },
    "outputPath": [
      "./promptfoo-results.json"
    ],
    "extensions": [],
    "metadata": {},
    "evaluateOptions": {}
  },
  "shareableUrl": null,
  "metadata": {
    "promptfooVersion": "0.120.19",
    "nodeVersion": "v22.18.0",
    "platform": "darwin",
    "arch": "arm64",
    "exportedAt": "2026-02-07T13:14:08.186Z",
    "evaluationCreatedAt": "2026-02-07T12:43:51.183Z"
  }
}